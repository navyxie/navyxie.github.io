<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Navy&#39;s Blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.navyxie.com/"/>
  <updated>2016-07-24T05:01:58.000Z</updated>
  <id>http://www.navyxie.com/</id>
  
  <author>
    <name>Navy xie</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>nodejs-path</title>
    <link href="http://www.navyxie.com/2016/07/24/nodejs-path/"/>
    <id>http://www.navyxie.com/2016/07/24/nodejs-path/</id>
    <published>2016-07-24T03:28:13.000Z</published>
    <updated>2016-07-24T05:01:58.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;nodejs-关于路径处理的相关问题&quot;&gt;&lt;a href=&quot;#nodejs-关于路径处理的相关问题&quot; class=&quot;headerlink&quot; title=&quot;nodejs 关于路径处理的相关问题&quot;&gt;&lt;/a&gt;nodejs 关于路径处理的相关问题&lt;/h2&gt;&lt;h3 id=&quot;路劲分类&quot;&gt;&lt;a href=&quot;#路劲分类&quot; class=&quot;headerlink&quot; title=&quot;路劲分类&quot;&gt;&lt;/a&gt;路劲分类&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;相对路径&lt;ul&gt;
&lt;li&gt;../xxx/a.jpg&lt;/li&gt;
&lt;li&gt;./xxx/a.jpg&lt;/li&gt;
&lt;li&gt;xxx/a.jpg&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;相对于网站的根目录&lt;ul&gt;
&lt;li&gt;/xxx/a.jpg&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;绝对路径(一般都不会用)&lt;ul&gt;
&lt;li&gt;/Users/Navy/Desktop/code/demo/xxx/a.jpg&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在web项目的前端发布构建过程中，经常需要处理css中的图片路径，清理图片缓存，上传图片到CDN等，所以一定会面临路径问题，而前端构建发布过程中经常借助nodejs。css中的图片使用最多的就是相对路径，以及相对于网站站点的根目录。&lt;/p&gt;
&lt;h4 id=&quot;对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path-resolve函数即可获取到图片的绝对路径。&quot;&gt;&lt;a href=&quot;#对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path-resolve函数即可获取到图片的绝对路径。&quot; class=&quot;headerlink&quot; title=&quot;对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path.resolve函数即可获取到图片的绝对路径。&quot;&gt;&lt;/a&gt;对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path.resolve函数即可获取到图片的绝对路径。&lt;/h4&gt;&lt;h4 id=&quot;相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public-static-assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path-join函数也能比较好的处理这个路径问题。&quot;&gt;&lt;a href=&quot;#相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public-static-assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path-join函数也能比较好的处理这个路径问题。&quot; class=&quot;headerlink&quot; title=&quot;相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public,static,assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path.join函数也能比较好的处理这个路径问题。&quot;&gt;&lt;/a&gt;相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public,static,assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path.join函数也能比较好的处理这个路径问题。&lt;/h4&gt;&lt;h2 id=&quot;nodejs-处理路径常用的函数&quot;&gt;&lt;a href=&quot;#nodejs-处理路径常用的函数&quot; class=&quot;headerlink&quot; title=&quot;nodejs 处理路径常用的函数&quot;&gt;&lt;/a&gt;nodejs 处理路径常用的函数&lt;/h2&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;文件路径处理：path.normalize(p)&lt;br&gt;path模块中的normalize()方法用来规范化路径字符串。可用于处理路径中的”//“、”..”、”.”等字符。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var path = require(&amp;apos;path&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.normalize(&amp;apos;/foo/bar//baz/asdf/quux/..&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 处理后&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;/foo/bar/baz/asdf&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;连接路径：path.join([path1][, path2][, …])&lt;br&gt;path.join()方法可以连接任意多个路径字符串。要连接的多个路径可做为参数传入。path.join()方法在接边路径的同时也会对路径进行规范化。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var path = require(&amp;apos;path&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//合法的字符串连接&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.join(&amp;apos;/foo&amp;apos;, &amp;apos;bar&amp;apos;, &amp;apos;baz/asdf&amp;apos;, &amp;apos;quux&amp;apos;, &amp;apos;..&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 连接后&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;/foo/bar/baz/asdf&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;路径解析：path.resolve([from …], to)&lt;br&gt;path.resolve()方法可以将多个路径解析为一个规范化的绝对路径。其处理方式类似于对这些路径逐一进行cd操作，与cd操作不同的是，这引起路径可以是文件，并且可不必实际存在（resolve()方法不会利用底层的文件系统判断路径是否存在，而只是进行路径字符串操作）。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;path.resolve(&amp;apos;foo/bar&amp;apos;, &amp;apos;/tmp/file/&amp;apos;, &amp;apos;..&amp;apos;, &amp;apos;a/../subfile&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// /tmp/subfile&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其处理方式类型于&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cd foo/bar&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cd /tmp/file/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cd ..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cd a/../subfile&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pwd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果解析的不是绝对路径，path.resolve()会将当前工作目录加到解析结果的前面。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;path.resolve(&amp;apos;/foo/bar&amp;apos;, &amp;apos;./baz&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 输出结果为&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;/foo/bar/baz&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.resolve(&amp;apos;/foo/bar&amp;apos;, &amp;apos;/tmp/file/&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 输出结果为&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;/tmp/file&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.resolve(&amp;apos;wwwroot&amp;apos;, &amp;apos;static_files/png/&amp;apos;, &amp;apos;../gif/image.gif&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 当前的工作路径是 /Users/Navy/Desktop/code/demo/node_modules/gulp-custom-css-urls，则输出结果为&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;/home/itbilu/node/wwwroot/static_files/gif/image.gif&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从上面的例子可以看出,resolve函数处理的原则是，当路径有含有多个绝对路径时（以/开头的路径）,只会处理最后一个绝对路径（以最后一个绝对路径为起始路径），忽略之前所有的路径，当所有路径都没有绝对路劲时，最后会把当前工作路径（process.cwd()）添加到开头。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;查找两个绝对路径的相对关系：path.relative(from, to)&lt;br&gt;path.relative()方法可以找出一个绝对路径到另一个绝对路径的相对关系（前面一个路径相对后面的路径）。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var path = require(&amp;apos;path&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.relative(&amp;apos;/Users/liuht/code/itbilu/demo&amp;apos;, &amp;apos;/Users/liuht/code/zszsgc/lib&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 结果&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;../../zszsgc/lib&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;提取路径的组成部分：path.dirname(p) 、path.basename(p[, ext]) 、path.extname(p)&lt;br&gt;path.dirname()方法可以提取出一个文件路径中的目录的部分。path.basename()方法可以提取出一个文件路径中的文件的部分。path.extname()方法可以提取文件的扩展名。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var path = require(&amp;apos;path&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.dirname(&amp;apos;/Users/liuht/code/itbilu/demo/path.js&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 结果&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;/Users/liuht/code/itbilu/demo&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.basename(&amp;apos;/Users/liuht/code/itbilu/demo/path.js&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 结果&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;path.js&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.extname(&amp;apos;/Users/liuht/code/itbilu/demo/path.js&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 结果&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;.js&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;path.basename()方法还可以指定第二个参数：文件的扩展名，指定后可以提取文件名。指定扩展名不合法时将返回文件全名。例如：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var path = require(&amp;apos;path&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.basename(&amp;apos;/Users/liuht/code/itbilu/demo/path.js&amp;apos;, &amp;apos;.js&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 结果&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;path&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path.basename(&amp;apos;/Users/liuht/code/itbilu/demo/path.js&amp;apos;, &amp;apos;.html&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 结果&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;apos;path.js&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;在早期的Node.js版本中path模块还有个path.exists()方法，用于判断文件是否存在，但已被fs模块中的fs.exists()代替。&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;nodejs-关于路径处理的相关问题&quot;&gt;&lt;a href=&quot;#nodejs-关于路径处理的相关问题&quot; class=&quot;headerlink&quot; title=&quot;nodejs 关于路径处理的相关问题&quot;&gt;&lt;/a&gt;nodejs 关于路径处理的相关问题&lt;/h2&gt;&lt;h3 id=&quot;路劲分类&quot;&gt;&lt;a href=&quot;#路劲分类&quot; class=&quot;headerlink&quot; title=&quot;路劲分类&quot;&gt;&lt;/a&gt;路劲分类&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;相对路径&lt;ul&gt;
&lt;li&gt;../xxx/a.jpg&lt;/li&gt;
&lt;li&gt;./xxx/a.jpg&lt;/li&gt;
&lt;li&gt;xxx/a.jpg&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;相对于网站的根目录&lt;ul&gt;
&lt;li&gt;/xxx/a.jpg&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;绝对路径(一般都不会用)&lt;ul&gt;
&lt;li&gt;/Users/Navy/Desktop/code/demo/xxx/a.jpg&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在web项目的前端发布构建过程中，经常需要处理css中的图片路径，清理图片缓存，上传图片到CDN等，所以一定会面临路径问题，而前端构建发布过程中经常借助nodejs。css中的图片使用最多的就是相对路径，以及相对于网站站点的根目录。&lt;/p&gt;
&lt;h4 id=&quot;对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path-resolve函数即可获取到图片的绝对路径。&quot;&gt;&lt;a href=&quot;#对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path-resolve函数即可获取到图片的绝对路径。&quot; class=&quot;headerlink&quot; title=&quot;对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path.resolve函数即可获取到图片的绝对路径。&quot;&gt;&lt;/a&gt;对于相对目录比较好处理，根据css当前路径和图片的相对路径，使用nodejs的path.resolve函数即可获取到图片的绝对路径。&lt;/h4&gt;&lt;h4 id=&quot;相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public-static-assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path-join函数也能比较好的处理这个路径问题。&quot;&gt;&lt;a href=&quot;#相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public-static-assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path-join函数也能比较好的处理这个路径问题。&quot; class=&quot;headerlink&quot; title=&quot;相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public,static,assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path.join函数也能比较好的处理这个路径问题。&quot;&gt;&lt;/a&gt;相对于网站的根目录就稍微有点麻烦，因为当前css的路径是没啥作用，需要根据网站设置的静态文件目录处理，一般静态文件目录是public,static,assets等，那么根据静态文件目录和图片的路径及应用程序的根目录，通过nodejs的path.join函数也能比较好的处理这个路径问题。&lt;/h4&gt;&lt;h2 id=&quot;nodejs-处理路径常用的函数&quot;&gt;&lt;a href=&quot;#nodejs-处理路径常用的函数&quot; class=&quot;headerlink&quot; title=&quot;nodejs 处理路径常用的函数&quot;&gt;&lt;/a&gt;nodejs 处理路径常用的函数&lt;/h2&gt;
    
    </summary>
    
      <category term="nodejs" scheme="http://www.navyxie.com/categories/nodejs/"/>
    
      <category term="path" scheme="http://www.navyxie.com/categories/nodejs/path/"/>
    
    
      <category term="nodejs" scheme="http://www.navyxie.com/tags/nodejs/"/>
    
      <category term="path" scheme="http://www.navyxie.com/tags/path/"/>
    
  </entry>
  
  <entry>
    <title>influx_query_language</title>
    <link href="http://www.navyxie.com/2016/07/15/influx-query-language/"/>
    <id>http://www.navyxie.com/2016/07/15/influx-query-language/</id>
    <published>2016-07-15T07:25:44.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;p&gt;InfluxQL is an SQL-like query language for interacting with data in InfluxDB. The following sections cover useful query syntax for exploring your data.&lt;/p&gt;
&lt;h3 id=&quot;WHERE-clause-in-InfluxQL&quot;&gt;&lt;a href=&quot;#WHERE-clause-in-InfluxQL&quot; class=&quot;headerlink&quot; title=&quot;WHERE clause in InfluxQL:&quot;&gt;&lt;/a&gt;WHERE clause in InfluxQL:&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;The &lt;code&gt;WHERE&lt;/code&gt; clause supports comparisons against strings, booleans, floats, integers, and against the &lt;code&gt;time&lt;/code&gt; of the timestamp. It supports using regular expressions to match tags, but not to match fields.&lt;/li&gt;
&lt;li&gt;Chain logic together using &lt;code&gt;AND&lt;/code&gt; and &lt;code&gt;OR&lt;/code&gt;, and separate using &lt;code&gt;(&lt;/code&gt; and &lt;code&gt;)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Acceptable comparators include:&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;= equal to&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;&amp;gt; not equal to&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;!= not equal to&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt; greater than&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt; less than&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;=~ matches against&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;!~ doesn’t match against&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;The-basics&quot;&gt;&lt;a href=&quot;#The-basics&quot; class=&quot;headerlink&quot; title=&quot;The basics:&quot;&gt;&lt;/a&gt;The basics:&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;The &lt;code&gt;SELECT&lt;/code&gt; statement and the &lt;code&gt;WHERE&lt;/code&gt; clause&lt;ul&gt;
&lt;li&gt;The basic &lt;code&gt;SELECT&lt;/code&gt; statement&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;SELECT&lt;/code&gt; statement and arithmetic&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;WHERE&lt;/code&gt; clause&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The GROUP BY clause&lt;ul&gt;
&lt;li&gt;The basic &lt;code&gt;GROUP BY&lt;/code&gt; clause&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;GROUP BY&lt;/code&gt; clause and &lt;code&gt;fill()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The INTO clause&lt;ul&gt;
&lt;li&gt;Relocate data&lt;/li&gt;
&lt;li&gt;Downsample data&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Limit-and-sort-your-results&quot;&gt;&lt;a href=&quot;#Limit-and-sort-your-results&quot; class=&quot;headerlink&quot; title=&quot;Limit and sort your results:&quot;&gt;&lt;/a&gt;Limit and sort your results:&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Limit query returns with &lt;code&gt;LIMIT&lt;/code&gt; and &lt;code&gt;SLIMIT&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;Limit results per series with LIMIT&lt;/li&gt;
&lt;li&gt;Limit the number of series returned with SLIMIT&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Sort query returns with ORDER BY time DESC&lt;/li&gt;
&lt;li&gt;Paginate query returns with OFFSET&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;General-tips-on-query-syntax&quot;&gt;&lt;a href=&quot;#General-tips-on-query-syntax&quot; class=&quot;headerlink&quot; title=&quot;General tips on query syntax:&quot;&gt;&lt;/a&gt;General tips on query syntax:&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Multiple statements in queries&lt;/li&gt;
&lt;li&gt;Merge series in queries&lt;/li&gt;
&lt;li&gt;Time syntax in queries&lt;ul&gt;
&lt;li&gt;Relative time&lt;/li&gt;
&lt;li&gt;Absolute time&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Regular expressions in queries&lt;ul&gt;
&lt;li&gt;Regular expressions and selecting measurements&lt;/li&gt;
&lt;li&gt;Regular expressions and specifying tags&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The examples below query data using InfluxDB’s Command Line Interface (CLI). See the Querying Data guide for how to query data directly using the HTTP API.&lt;/p&gt;
&lt;h2 id=&quot;Sample-data&quot;&gt;&lt;a href=&quot;#Sample-data&quot; class=&quot;headerlink&quot; title=&quot;Sample data&quot;&gt;&lt;/a&gt;Sample data&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;If you’d like to follow along with the queries in this document, see Sample Data for how to download and write the data to InfluxDB. This document uses publicly available data from the National Oceanic and Atmospheric Administration’s (NOAA) Center for Operational Oceanographic Products and Services. The data include water levels (ft) collected every six seconds at two stations (Santa Monica, CA (ID 9410840) and Coyote Creek, CA (ID 9414575)) over the period from August 18, 2015 through September 18, 2015. A subsample of the data in the measurement h2o_feet:&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                             level description        location         water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z       below 3 feet               santa_monica     2.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z       between 6 and 9 feet    coyote_creek    8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z       between 6 and 9 feet    coyote_creek    8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z       below 3 feet               santa_monica     2.116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z       between 6 and 9 feet    coyote_creek    7.887&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z       below 3 feet               santa_monica     2.028&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:18:00Z       between 6 and 9 feet    coyote_creek    7.762&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:18:00Z       below 3 feet               santa_monica     2.126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z       between 6 and 9 feet    coyote_creek    7.635&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z       below 3 feet               santa_monica     2.041&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The &lt;code&gt;series&lt;/code&gt; are made up of the &lt;code&gt;measurement&lt;/code&gt; &lt;code&gt;h2o_feet&lt;/code&gt; and the &lt;code&gt;tag key&lt;/code&gt; &lt;code&gt;location&lt;/code&gt; with the &lt;code&gt;tag values&lt;/code&gt; &lt;code&gt;santa_monica&lt;/code&gt; and &lt;code&gt;coyote_creek&lt;/code&gt;. There are two fields: &lt;code&gt;water_level&lt;/code&gt; which stores floats and &lt;code&gt;level description&lt;/code&gt; which stores strings. All of the data are in the &lt;code&gt;NOAA_water_database&lt;/code&gt; database.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Disclaimer: The level description field isn’t part of the original NOAA data - we snuck it in there for the sake of having a field key with a special character and string field values.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;The-SELECT-statement-and-the-WHERE-clause&quot;&gt;&lt;a href=&quot;#The-SELECT-statement-and-the-WHERE-clause&quot; class=&quot;headerlink&quot; title=&quot;The SELECT statement and the WHERE clause&quot;&gt;&lt;/a&gt;The SELECT statement and the WHERE clause&lt;/h1&gt;&lt;p&gt;InfluxQL’s &lt;code&gt;SELECT&lt;/code&gt; statement follows the form of an SQL &lt;code&gt;SELECT&lt;/code&gt; statement where the &lt;code&gt;WHERE&lt;/code&gt; clause is optional:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT &amp;lt;stuff&amp;gt; FROM &amp;lt;measurement_name&amp;gt; WHERE &amp;lt;some_conditions&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;The-basic-SELECT-statement&quot;&gt;&lt;a href=&quot;#The-basic-SELECT-statement&quot; class=&quot;headerlink&quot; title=&quot;The basic SELECT statement&quot;&gt;&lt;/a&gt;The basic SELECT statement&lt;/h4&gt;&lt;p&gt;The following three examples return everything from the measurement h2o_feet (see the CLI response at the end of this section). While they all return the same result, they get to that result in slightly different ways and serve to introduce some of the specifics of the SELECT syntax:&lt;/p&gt;
&lt;p&gt;Select everything from h2o_feet with *:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Select everything from h2o_feet by specifying each tag key and field key:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT &amp;quot;level description&amp;quot;,location,water_level FROM h2o_feet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Separate multiple fields and tags of interest with a comma. Note that you must specify at least one field in the SELECT statement.&lt;/li&gt;
&lt;li&gt;Leave identifiers unquoted unless they start with a digit, contain characters other than [A-z,0-9,_], or if they are an InfluxQL keyword then you need to double quote them. Identifiers are database names, retention policy names, user names&lt;/li&gt;
&lt;li&gt;measurement names, tag keys, and field keys.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Select everything from h2o_feet by fully qualifying the measurement:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM NOAA_water_database.&amp;quot;default&amp;quot;.h2o_feet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Fully qualify a measurement if you wish to query data from a different database or from a retention policy other than the default retention policy. A fully qualified measurement takes the following form:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;quot;&amp;lt;database&amp;gt;&amp;quot;.&amp;quot;&amp;lt;retention policy&amp;gt;&amp;quot;.&amp;quot;&amp;lt;measurement&amp;gt;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The CLI response for all three queries:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                             level description        location         water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z       below 3 feet               santa_monica     2.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z       between 6 and 9 feet    coyote_creek    8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z       between 6 and 9 feet    coyote_creek    8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z       below 3 feet               santa_monica     2.116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[...]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:24:00Z       between 3 and 6 feet    santa_monica    5.013&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:30:00Z       between 3 and 6 feet    santa_monica    5.01&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:36:00Z       between 3 and 6 feet    santa_monica    5.066&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:42:00Z       between 3 and 6 feet    santa_monica    4.938&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;The-SELECT-statement-and-arithmetic&quot;&gt;&lt;a href=&quot;#The-SELECT-statement-and-arithmetic&quot; class=&quot;headerlink&quot; title=&quot;The SELECT statement and arithmetic&quot;&gt;&lt;/a&gt;The SELECT statement and arithmetic&lt;/h3&gt;&lt;p&gt;Perform basic arithmetic operations on fields that store floats and integers.&lt;br&gt;Add two to the field water_level:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level + 2 FROM h2o_feet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    4.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    10.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[...]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:36:00Z    7.066&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:42:00Z    6.938&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Another example that works:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT (water_level * 2) + 4 from h2o_feet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    8.128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    20.24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[...]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:36:00Z    14.132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:42:00Z    13.876&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Note: When performing arithmetic on fields that store integers be aware that InfluxDB casts those integers to floats for all mathematical operations. This can lead to overflow issues for some numbers.&lt;/p&gt;
&lt;h3 id=&quot;The-WHERE-clause&quot;&gt;&lt;a href=&quot;#The-WHERE-clause&quot; class=&quot;headerlink&quot; title=&quot;The WHERE clause&quot;&gt;&lt;/a&gt;The WHERE clause&lt;/h3&gt;&lt;p&gt;Use a WHERE clause to filter your data based on tags, time ranges, and/or field values.&lt;/p&gt;
&lt;p&gt;Tags&lt;br&gt;Return data where the tag key location has the tag value santa_monica:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE location = &amp;apos;santa_monica&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Always single quote tag values in queries - they are strings. Note that double quotes do not work when specifying tag values and can cause queries to silently fail.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: Tags are indexed so queries on tag keys or tag values are more performant than queries on fields.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Return data where the tag key location has no tag value (more on regular expressions later):&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE location !~ /.*/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Return data where the tag key location has a value:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE location =~ /.*/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Time ranges&lt;br&gt;Return data from the past seven days:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE time &amp;gt; now() - 7d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;now() is the Unix time of the server at the time the query is executed on that server. For more on now() and other ways to specify time in queries, see time syntax in queries.&lt;/p&gt;
&lt;p&gt;Field values&lt;br&gt;Return data where the tag key location has the tag value coyote_creek and the field water_level is greater than 8 feet:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE location = &amp;apos;coyote_creek&amp;apos; AND  water_level &amp;gt; 8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Return data where the tag key location has the tag value santa_monica and the field level description equals ‘below 3 feet’:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE location = &amp;apos;santa_monica&amp;apos; AND &amp;quot;level description&amp;quot; = &amp;apos;below 3 feet&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Always single quote field values that are strings. Note that double quotes do not work when specifying string field values and can cause queries to silently fail.&lt;/p&gt;
&lt;p&gt;Note: Fields are not indexed; queries on fields are not as performant as those on tags.&lt;/p&gt;
&lt;h2 id=&quot;The-GROUP-BY-clause&quot;&gt;&lt;a href=&quot;#The-GROUP-BY-clause&quot; class=&quot;headerlink&quot; title=&quot;The GROUP BY clause&quot;&gt;&lt;/a&gt;The GROUP BY clause&lt;/h2&gt;&lt;p&gt;Use the &lt;code&gt;GROUP BY&lt;/code&gt; clause to group data by tags and/or time intervals. To successfully implement &lt;code&gt;GROUP BY&lt;/code&gt;, append the &lt;code&gt;GROUP BY&lt;/code&gt; clause to a &lt;code&gt;SELECT&lt;/code&gt; statement and pair the &lt;code&gt;SELECT&lt;/code&gt; statement with one of InfluxQL’s functions.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: If your query includes both a WHERE clause and a GROUP BY clause, the GROUP BY clause must come after the WHERE clause.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The basic GROUP BY clause&lt;/p&gt;
&lt;p&gt;GROUP BY tag values&lt;/p&gt;
&lt;p&gt;Calculate the MEAN() water_level for the different tag values of location:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT MEAN(water_level) FROM h2o_feet GROUP BY location&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location=coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----            ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z    5.359342451341403&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location=santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----            ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z    3.5308634700810053&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: In InfluxDB, epoch 0 (1970-01-01T00:00:00Z) is often used as a null timestamp equivalent. If you request a query that has no timestamp to return, such as an aggregation function with an unbounded time range, InfluxDB returns epoch 0 as the timestamp.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Calculate the MEAN() index for every tag set in h2o_quality:&lt;/p&gt;
&lt;p&gt;SELECT MEAN(index) FROM h2o_quality GROUP BY *&lt;/p&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location = coyote_creek, randtag = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                           ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     50.69033760186263&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location = coyote_creek, randtag = 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                           ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     49.661867544220485&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location = coyote_creek, randtag = 3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                           ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     49.360939907550076&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location = santa_monica, randtag = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                           ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     49.132712456344585&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location = santa_monica, randtag = 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                           ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     50.2937984496124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location = santa_monica, randtag = 3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                           ----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     49.99919903884662&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;GROUP BY time intervals&lt;/p&gt;
&lt;p&gt;GROUP BY time intervals&lt;br&gt;COUNT() the number of water_level points between August 18, 2015 at midnight and September 18 at 5:00pm at two day intervals:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT COUNT(water_level) FROM h2o_feet WHERE time &amp;gt;= &amp;apos;2015-08-18T00:00:00Z&amp;apos; AND time &amp;lt;= &amp;apos;2015-09-18T17:00:00Z&amp;apos; AND location=&amp;apos;coyote_creek&amp;apos; GROUP BY time(2d)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           count&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-17T00:00:00Z     240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-19T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-21T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-23T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-25T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-27T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-29T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-31T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-02T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-04T00:00:00Z     479&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-06T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-08T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-10T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-12T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-14T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-16T00:00:00Z     480&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T00:00:00Z     165&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Notice that each timestamp represents a two day interval and that the value in the count field is the number of water_level points that occurred in that two day interval. You could get the same results by querying the data 17 times - that is, one COUNT() query for every two days between August 18, 2015 at midnight and September 18 at 5:00pm - but that could take a while.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: The first timestamp in the CLI response (2015-08-17T00:00:00Z) occurs before the lower bound of the query’s time range (2015-08-18T00:00:00Z). See Frequently Encountered Issues for an explanation of the time intervals returned from GROUP BY time() queries.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Other things to note about GROUP BY time():&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;InfluxQL requires a WHERE clause if you’re using GROUP BY with time(). Note that unless you specify a different upper and lower bound for the time range, GROUP BY uses epoch 0 as the lower bound and now() as the upper bound for the query - this can lead to unexpected results.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Valid units for time() are:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;`u` microseconds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`ms` milliseconds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`s` seconds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`m` minutes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`h` hours&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`d` days&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`w` weeks&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;GROUP BY tag values AND a time interval&lt;/p&gt;
&lt;p&gt;Calculate the average water_level for the different tag values of location in the last two weeks at 6 hour intervals:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT MEAN(water_level) FROM h2o_feet WHERE time &amp;gt; now() - 2w GROUP BY location,time(6h)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Separate multiple GROUP BY arguments with a comma.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;The-GROUP-BY-clause-and-fill&quot;&gt;&lt;a href=&quot;#The-GROUP-BY-clause-and-fill&quot; class=&quot;headerlink&quot; title=&quot;The GROUP BY clause and fill()&quot;&gt;&lt;/a&gt;The GROUP BY clause and fill()&lt;/h3&gt;&lt;p&gt;By default, a GROUP BY interval with no data has null as its value in the output column. Use fill() to change the value reported for intervals that have no data. fill() options include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Any numerical value&lt;/li&gt;
&lt;li&gt;null - sets null as the value for intervals with no data&lt;/li&gt;
&lt;li&gt;previous - copies the value from the previous interval for intervals with no data&lt;/li&gt;
&lt;li&gt;none - skips intervals with no data to report&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Follow the ✨ in the examples below to see what fill() can do.&lt;/p&gt;
&lt;p&gt;GROUP BY without fill()&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT MEAN(water_level) FROM h2o_feet WHERE time &amp;gt;= &amp;apos;2015-08-18&amp;apos; AND time &amp;lt; &amp;apos;2015-09-24&amp;apos; GROUP BY time(10d)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-13T00:00:00Z    4.306212083333333&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-23T00:00:00Z    4.328549999999998&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-02T00:00:00Z    4.44695286757038&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-12T00:00:00Z    4.701986209010117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;✨2015-09-22T00:00:00Z&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;GROUP BY with fill()&lt;/p&gt;
&lt;p&gt;Use fill() with -100:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT MEAN(water_level) FROM h2o_feet WHERE time &amp;gt;= &amp;apos;2015-08-18&amp;apos; AND time &amp;lt; &amp;apos;2015-09-24&amp;apos; GROUP BY time(10d) fill(-100)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-13T00:00:00Z    4.306212083333323&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-23T00:00:00Z    4.328549999999999&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-02T00:00:00Z    4.4469528675703796&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-12T00:00:00Z    4.701986209010117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;✨2015-09-22T00:00:00Z   -100&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Use fill() with none:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT MEAN(water_level) FROM h2o_feet WHERE time &amp;gt;= &amp;apos;2015-08-18&amp;apos; AND time &amp;lt; &amp;apos;2015-09-24&amp;apos; GROUP BY time(10d) fill(none)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-13T00:00:00Z    4.306212083333333&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-23T00:00:00Z    4.32855&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-02T00:00:00Z    4.4469528675703796&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-12T00:00:00Z    4.701986209010117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;✨&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: If you’re GROUP(ing) BY several things (for example, both tags and a time interval) fill() must go at the end of the GROUP BY clause.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The INTO clause&lt;/p&gt;
&lt;p&gt;Relocate data&lt;/p&gt;
&lt;p&gt;Copy data to another database, retention policy, and measurement with the INTO clause:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT &amp;lt;field_key&amp;gt; INTO &amp;lt;different_measurement&amp;gt; FROM &amp;lt;current_measurement&amp;gt; [WHERE &amp;lt;stuff&amp;gt;] [GROUP BY &amp;lt;stuff&amp;gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Write the field water_level in h2o_feet to a new measurement (h2o_feet_copy) in the same database:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level INTO h2o_feet_copy FROM h2o_feet WHERE location = &amp;apos;coyote_creek&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The CLI response shows the number of points that InfluxDB wrote to h2o_feet_copy:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: result&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           written&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     7604&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Write the field water_level in h2o_feet to a new measurement (h2o_feet_copy) and to the retention policy default in the database where_else:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level INTO where_else.&amp;quot;default&amp;quot;.h2o_feet_copy FROM h2o_feet WHERE location = &amp;apos;coyote_creek&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: result&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           written&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     7604&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: If you use SELECT * with INTO, the query converts tags in the current measurement to fields in the new measurement. This can cause InfluxDB to overwrite points that were previously differentiated by a tag value. Use GROUP BY &lt;tag_key&gt; to preserve tags as tags.&lt;/tag_key&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Downsample data&lt;/p&gt;
&lt;p&gt;Combine the INTO clause with an InfluxQL function and a GROUP BY clause to write the lower precision query results to a different measurement:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT &amp;lt;function&amp;gt;(&amp;lt;field_key&amp;gt;) INTO &amp;lt;different_measurement&amp;gt; FROM &amp;lt;current_measurement&amp;gt; WHERE &amp;lt;stuff&amp;gt; GROUP BY &amp;lt;stuff&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: The INTO queries in this section downsample old data, that is, data that have already been written to InfluxDB. If you want InfluxDB to automatically query and downsample all future data see Continuous Queries.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Calculate the average water_level in santa_monica, and write the results to a new measurement (average) in the same database:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT mean(water_level) INTO average FROM h2o_feet WHERE location = &amp;apos;santa_monica&amp;apos; AND time &amp;gt;= &amp;apos;2015-08-18T00:00:00Z&amp;apos; AND time &amp;lt;= &amp;apos;2015-08-18T00:30:00Z&amp;apos; GROUP BY time(12m)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The CLI response shows the number of points that InfluxDB wrote to the new measurement:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: result&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           written&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;To see the query results, select everything from the new measurement average in NOAA_water_database:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM average&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: average&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z     2.09&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z     2.077&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z     2.0460000000000003&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Calculate the average water_level and the max water_level in santa_monica, and write the results to a new measurement (aggregates) in a different database (where_else):&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT mean(water_level), max(water_level) INTO where_else.&amp;quot;default&amp;quot;.aggregates FROM h2o_feet WHERE location = &amp;apos;santa_monica&amp;apos; AND time &amp;gt;= &amp;apos;2015-08-18T00:00:00Z&amp;apos; AND time &amp;lt;= &amp;apos;2015-08-18T00:30:00Z&amp;apos; GROUP BY time(12m)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: result&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           written&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Select everything from the new measurement aggregates in the database where_else:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM where_else.&amp;quot;default&amp;quot;.aggregates&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: aggregates&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           max     mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z     2.116   2.09&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z     2.126   2.077&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z     2.051   2.0460000000000003&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Calculate the average degrees for all temperature measurements (h2o_temperature and average_temperature) in the NOAA_water_database and write the results to new measurements with the same names in a different database (where_else). :MEASUREMENT tells InfluxDB to write the query results to measurements with the same names as those targeted by the query:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT mean(degrees) INTO where_else.&amp;quot;default&amp;quot;.:MEASUREMENT FROM /temperature/ WHERE time &amp;gt;= &amp;apos;2015-08-18T00:00:00Z&amp;apos; AND time &amp;lt;= &amp;apos;2015-08-18T00:30:00Z&amp;apos; GROUP BY time(12m)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: result&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           written&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z     6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Select the mean field from all new temperature measurements in the database where_else.&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT mean FROM where_else.&amp;quot;default&amp;quot;./temperature/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: average_temperature&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z     78.5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z     84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z     74.75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_temperature&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;---------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                            mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z      63.75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z      63.5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z      63.5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More on downsampling with INTO:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;InfluxDB does not store null values. Depending on the frequency of your data, the query results may be missing time intervals. Use fill() to ensure that every time interval appears in the results.&lt;/li&gt;
&lt;li&gt;The number of writes in the CLI response includes one write for every time interval in the query’s time range even if there is no data for some of the time intervals.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Limit query returns with LIMIT and SLIMIT&lt;/p&gt;
&lt;p&gt;SLIMIT InfluxQL supports two different clauses to limit your query results. Currently, they are mutually exclusive so you may use one or the other, but not both in the same query.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Please note that using LIMIT and SLIMIT without a GROUP BY * clause can cause unexpected results. See GitHub Issue #4232 for more information.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Limit the number of results returned per series with LIMIT&lt;/p&gt;
&lt;p&gt;Use LIMIT &lt;n&gt; with SELECT and GROUP BY * to return the first N points from each series.&lt;br&gt;Return the three oldest points from each series associated with the measurement h2o_feet:&lt;/n&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet GROUP BY * LIMIT 3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location=coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                          -----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z    7.887&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location=santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                          -----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    2.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    2.116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z    2.028&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: If N is greater than the number of points in the series, InfluxDB returns all points in the series.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Limit-the-number-of-series-returned-with-SLIMIT&quot;&gt;&lt;a href=&quot;#Limit-the-number-of-series-returned-with-SLIMIT&quot; class=&quot;headerlink&quot; title=&quot;Limit the number of series returned with SLIMIT&quot;&gt;&lt;/a&gt;Limit the number of series returned with SLIMIT&lt;/h3&gt;&lt;p&gt;Use SLIMIT &lt;n&gt; with SELECT and GROUP BY * to return every point from N series.&lt;br&gt;Return everything from one of the series associated with the measurement h2o_feet:&lt;/n&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet GROUP BY * SLIMIT 1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location=coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----                          -----&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z    7.887&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[...]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:12:00Z    3.402&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:18:00Z    3.314&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:24:00Z    3.235&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: If N is greater than the number of series associated with the specified measurement, InfluxDB returns all points from every series.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Sort-query-returns-with-ORDER-BY-time-DESC&quot;&gt;&lt;a href=&quot;#Sort-query-returns-with-ORDER-BY-time-DESC&quot; class=&quot;headerlink&quot; title=&quot;Sort query returns with ORDER BY time DESC&quot;&gt;&lt;/a&gt;Sort query returns with ORDER BY time DESC&lt;/h3&gt;&lt;p&gt;By default, InfluxDB returns results in ascending time order - so the first points that are returned are the oldest points by timestamp. Use ORDER BY time DESC to see the newest points by timestamp.&lt;/p&gt;
&lt;p&gt;Return the oldest five points from one series without ORDER BY time DESC:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE location = &amp;apos;santa_monica&amp;apos; LIMIT 5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    2.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    2.116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z    2.028&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:18:00Z    2.126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z    2.041&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Now include ORDER BY time DESC to get the newest five points from the same series:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE location = &amp;apos;santa_monica&amp;apos; ORDER BY time DESC LIMIT 5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:42:00Z    4.938&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:36:00Z    5.066&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:30:00Z    5.01&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:24:00Z    5.013&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:18:00Z    5.072&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Finally, use &lt;code&gt;GROUP BY&lt;/code&gt; with &lt;code&gt;ORDER BY time DESC&lt;/code&gt; to return the last five points from each series:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet GROUP BY location ORDER BY time DESC LIMIT 5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location=coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----            -----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:24:00Z    3.235&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:18:00Z    3.314&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:12:00Z    3.402&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:06:00Z    3.497&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T16:00:00Z    3.599&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tags: location=santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----            -----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:42:00Z    4.938&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:36:00Z    5.066&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:30:00Z    5.01&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:24:00Z    5.013&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-09-18T21:18:00Z    5.072&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;aginate-query-returns-with-OFFSET&quot;&gt;&lt;a href=&quot;#aginate-query-returns-with-OFFSET&quot; class=&quot;headerlink&quot; title=&quot;aginate query returns with OFFSET&quot;&gt;&lt;/a&gt;aginate query returns with OFFSET&lt;/h3&gt;&lt;p&gt;Use OFFSET to paginate the results returned. For example, get the first three points written to a series:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE location = &amp;apos;coyote_creek&amp;apos; LIMIT 3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z    7.887&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Then get the second three points from that same series:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE location = &amp;apos;coyote_creek&amp;apos; LIMIT 3 OFFSET 3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time            water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:18:00Z    7.762&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:24:00Z    7.635&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:30:00Z    7.5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Multiple-statements-in-queries&quot;&gt;&lt;a href=&quot;#Multiple-statements-in-queries&quot; class=&quot;headerlink&quot; title=&quot;Multiple statements in queries&quot;&gt;&lt;/a&gt;Multiple statements in queries&lt;/h3&gt;&lt;p&gt;Separate multiple statements in a query with a semicolon. For example: &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT mean(water_level) FROM h2o_feet WHERE time &amp;gt; now() - 2w GROUP BY location,time(24h) fill(none); SELECT count(water_level) FROM h2o_feet WHERE time &amp;gt; now() - 2w GROUP BY location,time(24h) fill(80)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Merge-series-in-queries&quot;&gt;&lt;a href=&quot;#Merge-series-in-queries&quot; class=&quot;headerlink&quot; title=&quot;Merge series in queries&quot;&gt;&lt;/a&gt;Merge series in queries&lt;/h3&gt;&lt;p&gt;In InfluxDB, queries merge series automatically.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;NOAA_water_database&lt;/code&gt; database has two &lt;code&gt;series&lt;/code&gt;. The first series is made up of the measurement &lt;code&gt;h2o_feet&lt;/code&gt; and the tag key &lt;code&gt;location&lt;/code&gt; with the tag value &lt;code&gt;coyote_creek&lt;/code&gt;. The second series is made of up the measurement &lt;code&gt;h2o_feet&lt;/code&gt; and the tag key &lt;code&gt;location&lt;/code&gt; with the tag value &lt;code&gt;santa_monica&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The following query automatically merges those two series when it calculates the MEAN() water_level:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT MEAN(water_level) FROM h2o_feet&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z    4.442107025822523&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;If you only want the MEAN() water_level for the first series, specify the tag set in the WHERE clause:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT MEAN(water_level) FROM h2o_feet WHERE location = &amp;apos;coyote_creek&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          mean&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1970-01-01T00:00:00Z    5.359342451341402&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;NOTE: In InfluxDB, epoch 0 (1970-01-01T00:00:00Z) is often used as a null timestamp equivalent. If you request a query that has no timestamp to return, such as an aggregation function with an unbounded time range, InfluxDB returns epoch 0 as the timestamp.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Time-syntax-in-queries&quot;&gt;&lt;a href=&quot;#Time-syntax-in-queries&quot; class=&quot;headerlink&quot; title=&quot;Time syntax in queries&quot;&gt;&lt;/a&gt;Time syntax in queries&lt;/h3&gt;&lt;p&gt;InfluxDB is a time series database so, unsurprisingly, InfluxQL has a lot to do with specifying time ranges. If you do not specify start and end times in your query, they default to epoch 0 (1970-01-01T00:00:00Z) and now(). The following sections detail how to specify different start and end times in queries.&lt;/p&gt;
&lt;h4 id=&quot;Relative-time&quot;&gt;&lt;a href=&quot;#Relative-time&quot; class=&quot;headerlink&quot; title=&quot;Relative time&quot;&gt;&lt;/a&gt;Relative time&lt;/h4&gt;&lt;p&gt;&lt;code&gt;now()&lt;/code&gt; is the Unix time of the server at the time the query is executed on that server. Use now() to calculate a timestamp relative to the server’s current timestamp.&lt;/p&gt;
&lt;p&gt;Query data starting an hour ago and ending &lt;code&gt;now():&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE time &amp;gt; now() - 1h&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Query data that occur between epoch 0 and 1,000 days from now():&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT &amp;quot;level description&amp;quot; FROM h2o_feet WHERE time &amp;lt; now() + 1000d&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Note the whitespace between the operator and the time duration. Leaving that whitespace out can cause InfluxDB to return no results or an error parsing query error .&lt;/p&gt;
&lt;p&gt;The other options for specifying time durations with now() are listed below.&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;`u` microseconds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`ms` milliseconds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`s` seconds&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`m` minutes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`h` hours&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`d` days&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;`w` weeks&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;Absolute-time&quot;&gt;&lt;a href=&quot;#Absolute-time&quot; class=&quot;headerlink&quot; title=&quot;Absolute time&quot;&gt;&lt;/a&gt;Absolute time&lt;/h4&gt;&lt;p&gt;Date time strings&lt;/p&gt;
&lt;p&gt;Specify time with date time strings. Date time strings can take two formats: YYYY-MM-DD HH:MM:SS.nnnnnnnnn and YYYY-MM-DDTHH:MM:SS.nnnnnnnnnZ, where the second specification is RFC3339. Nanoseconds (nnnnnnnnn) are optional in both formats.&lt;/p&gt;
&lt;p&gt;The following two queries query data between August 18, 2015 23:00:01.232000000 and September 19, 2015 00:00:00.&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE time &amp;gt; &amp;apos;2015-08-18 23:00:01.232000000&amp;apos; AND time &amp;lt; &amp;apos;2015-09-19&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT water_level FROM h2o_feet WHERE time &amp;gt; &amp;apos;2015-08-18T23:00:01.232000000Z&amp;apos; AND time &amp;lt; &amp;apos;2015-09-19&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Single quote the date time string. InfluxDB fails to restrict data by date time strings that are double quoted.&lt;/li&gt;
&lt;li&gt;If you only specify the date, InfluxDB sets the time to 00:00:00.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Epoch time&lt;br&gt;Specify time with timestamps in epoch time. Epoch time is the number of nanoseconds that have elapsed since 00:00:00 Coordinated Universal Time (UTC), Thursday, 1 January 1970. Indicate the units of the timestamp at the end of the timestamp (see the section above for a list of acceptable time units).&lt;br&gt;Return all points that occur after 2014-01-01 00:00:00:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE time &amp;gt; 1388534400s&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Regular-expressions-in-queries&quot;&gt;&lt;a href=&quot;#Regular-expressions-in-queries&quot; class=&quot;headerlink&quot; title=&quot;Regular expressions in queries&quot;&gt;&lt;/a&gt;Regular expressions in queries&lt;/h3&gt;&lt;p&gt;Regular expressions are surrounded by / characters and use Golang’s regular expression syntax. Use regular expressions when selecting measurements and tags.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: You cannot use regular expressions to match databases, retention policies, or fields. You can only use regular expressions to match measurements and tags.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The &lt;code&gt;sample data&lt;/code&gt; need to be more intricate for the following sections. Assume that the database &lt;code&gt;NOAA_water_database&lt;/code&gt; now holds several measurements: &lt;code&gt;h2o_feet&lt;/code&gt;, &lt;code&gt;h2o_quality&lt;/code&gt;, &lt;code&gt;h2o_pH&lt;/code&gt;, &lt;code&gt;average_temperature&lt;/code&gt;, and &lt;code&gt;h2o_temperature&lt;/code&gt;. Please note that every measurement besides h2o_feet is fictional and contains fictional data.&lt;/p&gt;
&lt;p&gt;Regular expressions and selecting measurements&lt;/p&gt;
&lt;p&gt;Select the oldest point from every measurement in the &lt;code&gt;NOAA_water_database&lt;/code&gt; database:&lt;/p&gt;
&lt;p&gt;SELECT &lt;em&gt; FROM /.&lt;/em&gt;/ LIMIT 1&lt;/p&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: average_temperature&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description   location        pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    85                                           santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description   location        pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z                        below 3 feet            santa_monica                     2.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_pH&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description   location        pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z                                                   santa_monica 6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-----------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description   location        pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z               41                                 coyote_creek        1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_temperature&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;---------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description   location        pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    70                                           santa_monica&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Alternatively, &lt;code&gt;SELECT&lt;/code&gt; all of the measurements in &lt;code&gt;NOAA_water_database&lt;/code&gt; by typing them out and separating each name with a comma (see below), but that could get tedious: &lt;code&gt;sql &amp;gt; SELECT * FROM average_temperature,h2o_feet,h2o_pH,h2o_quality,h2o_temperature LIMIT 1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Select the first three points from every measurement whose name starts with h2o:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM /^h2o/ LIMIT 3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description      location     pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z                        below 3 feet               santa_monica                 2.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z                        between 6 and 9 feet    coyote_creek                    8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z                        between 6 and 9 feet    coyote_creek                    8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_pH&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description      location     pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z                                                      santa_monica  6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z                                                      coyote_creek  7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z                                                      coyote_creek  8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_quality&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-----------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description      location     pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z               99                           santa_monica          2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z               41                           coyote_creek          1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z               11                           coyote_creek          3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_temperature&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;---------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   index   level description      location     pH  randtag water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    70                                                 santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    60                                                 coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    65                                                 coyote_creek&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Select the last 5 points from every measurement whose name contains temperature:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM /.*temperature.*/ LIMIT 5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: average_temperature&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-------------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   location&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    85       santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    82       coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    73       coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    74       santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z    86       coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_temperature&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;---------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                          degrees   location&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    70       santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z    60       coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    65       coyote_creek&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z    60       santa_monica&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z    68       coyote_creek&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Regular-expressions-and-specifying-tags&quot;&gt;&lt;a href=&quot;#Regular-expressions-and-specifying-tags&quot; class=&quot;headerlink&quot; title=&quot;Regular expressions and specifying tags&quot;&gt;&lt;/a&gt;Regular expressions and specifying tags&lt;/h3&gt;&lt;p&gt;Use regular expressions to specify tags in the WHERE clause. The relevant comparators include:&lt;/p&gt;
&lt;p&gt;=~ matches against&lt;br&gt;!~ doesn’t match against&lt;/p&gt;
&lt;p&gt;Select the oldest four points from the measurement &lt;code&gt;h2o_feet&lt;/code&gt; where the value of the tag &lt;code&gt;location&lt;/code&gt; does not include an a:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE location !~ /.*a.*/ LIMIT 4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           level description        location         water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z     between 6 and 9 feet   coyote_creek     8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z     between 6 and 9 feet    coyote_creek    8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:12:00Z     between 6 and 9 feet    coyote_creek    7.887&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:18:00Z     between 6 and 9 feet    coyote_creek    7.762&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Select the oldest four points from the measurement &lt;code&gt;h2o_feet&lt;/code&gt; where the value of the tag &lt;code&gt;location&lt;/code&gt; includes a &lt;code&gt;y&lt;/code&gt; or an &lt;code&gt;m&lt;/code&gt; and &lt;code&gt;water_level&lt;/code&gt; is greater than zero:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE (location =~ /.*y.*/ OR location =~ /.*m.*/) AND water_level &amp;gt; 0 LIMIT 4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;or&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SELECT * FROM h2o_feet WHERE location =~ /[ym]/ AND water_level &amp;gt; 0 LIMIT 4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;CLI response:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;name: h2o_feet&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;time                           level description        location         water_level&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z     below 3 feet               santa_monica     2.064&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:00:00Z     between 6 and 9 feet   coyote_creek     8.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z     between 6 and 9 feet   coyote_creek     8.005&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2015-08-18T00:06:00Z     below 3 feet               santa_monica     2.116&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;referrerr: &lt;a href=&quot;https://docs.influxdata.com/influxdb/v0.9/query_language/data_exploration&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://docs.influxdata.com/influxdb/v0.9/query_language/data_exploration&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      influx query language
    
    </summary>
    
      <category term="database" scheme="http://www.navyxie.com/categories/database/"/>
    
      <category term="influx" scheme="http://www.navyxie.com/categories/database/influx/"/>
    
      <category term="sql" scheme="http://www.navyxie.com/categories/database/influx/sql/"/>
    
    
      <category term="database" scheme="http://www.navyxie.com/tags/database/"/>
    
      <category term="influx" scheme="http://www.navyxie.com/tags/influx/"/>
    
      <category term="sql" scheme="http://www.navyxie.com/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>write-sails-hook</title>
    <link href="http://www.navyxie.com/2016/06/21/write-sails-hook/"/>
    <id>http://www.navyxie.com/2016/06/21/write-sails-hook/</id>
    <published>2016-06-21T10:03:05.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;how-to-write-one-sails-hook&quot;&gt;&lt;a href=&quot;#how-to-write-one-sails-hook&quot; class=&quot;headerlink&quot; title=&quot;how to write one sails-hook&quot;&gt;&lt;/a&gt;how to write one sails-hook&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;you module package.json must have key ‘sails’ , it’s a object, with contain key &lt;code&gt;isHook&lt;/code&gt;, if want to replace default hook, you can add key &lt;code&gt;hookName&lt;/code&gt;, eg: sails:{isHook:true,hookName:’orm’}&lt;/li&gt;
&lt;li&gt;export a function and return object, the first param is sails&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;sails-hook-how-to-load&quot;&gt;&lt;a href=&quot;#sails-hook-how-to-load&quot; class=&quot;headerlink&quot; title=&quot;sails hook how to load?&quot;&gt;&lt;/a&gt;sails hook how to load?&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;load hook principle : &lt;a href=&quot;https://github.com/balderdashy/sails/blob/v0.12.3/lib/hooks/moduleloader/index.js#L507&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/balderdashy/sails/blob/v0.12.3/lib/hooks/moduleloader/index.js#L507&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;replace default hook : &lt;a href=&quot;https://github.com/balderdashy/sails/blob/v0.12.3/lib/hooks/moduleloader/index.js#L513&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/balderdashy/sails/blob/v0.12.3/lib/hooks/moduleloader/index.js#L513&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;example&quot;&gt;&lt;a href=&quot;#example&quot; class=&quot;headerlink&quot; title=&quot;example&quot;&gt;&lt;/a&gt;example&lt;/h2&gt;&lt;p&gt;package.json&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;quot;version&amp;quot;:&amp;quot;0.0.1&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;quot;sails&amp;quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;quot;isHook&amp;quot;: true,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;quot;hookName&amp;quot;: &amp;quot;test&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;index.js(export)&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;module.exports = function(sails)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  console.log(&amp;apos;010101010101010101&amp;apos;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  return &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      how to write sails hook
    
    </summary>
    
      <category term="hook" scheme="http://www.navyxie.com/categories/hook/"/>
    
      <category term="sails" scheme="http://www.navyxie.com/categories/hook/sails/"/>
    
      <category term="module" scheme="http://www.navyxie.com/categories/hook/sails/module/"/>
    
    
      <category term="sails" scheme="http://www.navyxie.com/tags/sails/"/>
    
      <category term="hook" scheme="http://www.navyxie.com/tags/hook/"/>
    
  </entry>
  
  <entry>
    <title>sails-orm-bug</title>
    <link href="http://www.navyxie.com/2016/06/20/sails-orm-bug/"/>
    <id>http://www.navyxie.com/2016/06/20/sails-orm-bug/</id>
    <published>2016-06-20T11:38:39.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;p&gt;when your sails version &amp;gt;=  0.12.2 ,and your config/connection.js  adapter key is module ,such as : &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;devMongodb: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    module: &amp;apos;sails-mongo&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    host: process.env.MONGO_HOST || &amp;apos;localhost&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    port: process.env.MONGO_PORT || 57017,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    user: process.env.MONGO_USER || &amp;apos;&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    password: process.env.MONGO_PASS || &amp;apos;&amp;apos;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    database: process.env.MONGO_DBNAME || &amp;apos;koala&amp;apos;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;it will appear this error “Cannot read property ‘config’ of undefined”. Beacause sails version &amp;gt;= 0.12.2 orm is Separated into independent modules “sails-hook-orm” , this module don’t support ‘module’ key as adapter.&lt;/p&gt;
&lt;p&gt;you can solve it by two way:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;change adapter  key ‘module’ to ‘adapter’&lt;/li&gt;
&lt;li&gt;rockback sails to lower version (&amp;lt;=0.12.1) , and delete module “sails-hook-orm”&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;when you config multi adapter and the adapter key is ‘adapter’ , sails &amp;lt;= 0.12.1 with orm haved bug : &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/balderdashy/sails/blob/v0.12.1/lib/hooks/orm/build-orm.js#L26&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;origin code : https://github.com/balderdashy/sails/blob/v0.12.1/lib/hooks/orm/build-orm.js#L26&lt;/a&gt; &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sails.log.verbose(&amp;apos;Starting ORM...&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var waterline = new Waterline();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    _.each(modelDefs, function loadModelsIntoWaterline(modelDef, modelID) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      sails.log.silly(&amp;apos;Registering model `&amp;apos; + modelID + &amp;apos;` in Waterline (ORM)&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      waterline.loadCollection(Waterline.Collection.extend(modelDef));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    // Find all the connections used&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var connections = _.reduce(sails.adapters, function getConnectionsInPlay(connections, adapter, adapterKey) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      _.each(sails.config.connections, function(connection, connectionKey) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        if (adapterKey === connection.adapter) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          connections[connectionKey] = connection;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      return connections;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;, &amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;fix this bug : &lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sails.log.verbose(&amp;apos;Starting ORM...&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var connectionsNameList = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var waterline = new Waterline();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;_.each(modelDefs, function loadModelsIntoWaterline(modelDef, modelID) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    sails.log.silly(&amp;apos;Registering model `&amp;apos; + modelID + &amp;apos;` in Waterline (ORM)&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    connectionsNameList = connectionsNameList.concat(modelDef.connection);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    waterline.loadCollection(Waterline.Collection.extend(modelDef));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;connectionsNameList = _.uniq(connectionsNameList);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// Find all the connections used&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var connections = _.reduce(sails.adapters, function getConnectionsInPlay(connections, adapter, adapterKey) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;_.each(sails.config.connections, function(connection, connectionKey) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if (adapterKey === connection.adapter &amp;amp;&amp;amp; _.indexOf(connectionsNameList,connectionKey) !== -1) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        connections[connectionKey] = connection;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;return connections;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;, &amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      salis orm bug TypeError: Cannot read property &#39;config&#39; of undefined
    
    </summary>
    
      <category term="framework" scheme="http://www.navyxie.com/categories/framework/"/>
    
      <category term="sails" scheme="http://www.navyxie.com/categories/framework/sails/"/>
    
      <category term="nodejs" scheme="http://www.navyxie.com/categories/framework/sails/nodejs/"/>
    
      <category term="mvc" scheme="http://www.navyxie.com/categories/framework/sails/nodejs/mvc/"/>
    
    
      <category term="sails" scheme="http://www.navyxie.com/tags/sails/"/>
    
      <category term="orm" scheme="http://www.navyxie.com/tags/orm/"/>
    
      <category term="bug" scheme="http://www.navyxie.com/tags/bug/"/>
    
  </entry>
  
  <entry>
    <title>access-token</title>
    <link href="http://www.navyxie.com/2016/06/04/access-token/"/>
    <id>http://www.navyxie.com/2016/06/04/access-token/</id>
    <published>2016-06-04T06:50:42.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;p&gt;WEB应用是开放的，WEB前端代码也是公开的，和后端交互的接口如果没有经过特殊处理（加密/token），那么就是裸露的，只要知道api地址，那么就能随便获取应用数据。这样应用数据就很容易被人爬取或者恶意盗刷，典型的短信被恶意盗刷。&lt;/p&gt;
&lt;p&gt;公司理财产品的短信接口就是一个裸接口，只要手机号就可以任意盗刷，当然背后有根据手机号，ip地址做了请求限制，但还是不够。后面就加了一定时间内一定请求次数的Token，后面观察，基本没有被刷的迹象，说明新的机制还是起到很大作用。当然这个机制不仅是用于防短信盗刷，可用于任意的裸接口防护。&lt;/p&gt;
&lt;p&gt;原理很简单，就是在web页面请求的时候由后端按一定的算法注入token到页面中去，然后前端可以通过对应的规则取到token，在请求接口数据时带上去就能在后端对token进行验证，验证通过就能正常请求到数据。如果是native app ，可通过加密的方法请求接口来获取token，最简单直接的方式就是native app 客户端使用一段字符串+时间戳（从后端获取）进行加密，然后请求后端接口，接口对数据进行解密，对时间戳对比，在一段时间内认为有效（避免加密信息被拦截，所以加了时间戳校验），从而获取token。&lt;/p&gt;
&lt;p&gt;当然web应用都是公开的，所有源码理论上都是能获取到的。那么后端向web页面注入token的方式也能被破解，所以，后端注入token的形式可定制，比如注入到请求，或者自己实现一套算法，增加被破解的难度。&lt;/p&gt;
&lt;p&gt;把这套机制整理成一个独立的npm包&lt;a href=&quot;https://github.com/navyxie/access-token-api&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;access-token-api&lt;/a&gt;，方便多项目复用。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;使用例子：&quot;&gt;&lt;a href=&quot;#使用例子：&quot; class=&quot;headerlink&quot; title=&quot;使用例子：&quot;&gt;&lt;/a&gt;使用例子：&lt;/h3&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm install access-token-api&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//server(nodejs)  端&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; accessTokenApi = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;access-token-api&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; TokenApi = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; accessTokenApi(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    webTokenVarName:&lt;span class=&quot;string&quot;&gt;&#39;encrypt_api_tokenStr&#39;&lt;/span&gt;,&lt;span class=&quot;comment&quot;&gt;//前端可通过webTokenVarName变量去到token值，默认encrypt_api_tokenStr&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//web前端取token值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;[webTokenVarName] &lt;span class=&quot;comment&quot;&gt;//请求接口时带上这个值就能进行token校验了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;主要接口&quot;&gt;&lt;a href=&quot;#主要接口&quot; class=&quot;headerlink&quot; title=&quot;主要接口&quot;&gt;&lt;/a&gt;主要接口&lt;/h3&gt;&lt;p&gt;生成token api &lt;code&gt;issue&lt;/code&gt;&lt;br&gt;验证token api &lt;code&gt;verify&lt;/code&gt;&lt;br&gt;token 有效次数减一 api &lt;code&gt;decline&lt;/code&gt;&lt;br&gt;server 端 将token 注入到 web 前端页面 api &lt;code&gt;webInject&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;自定义后端注入token到web前端页面的方式，可以初始化模块时自定义webInject参数-函数&quot;&gt;&lt;a href=&quot;#自定义后端注入token到web前端页面的方式，可以初始化模块时自定义webInject参数-函数&quot; class=&quot;headerlink&quot; title=&quot;自定义后端注入token到web前端页面的方式，可以初始化模块时自定义webInject参数(函数)&quot;&gt;&lt;/a&gt;自定义后端注入token到web前端页面的方式，可以初始化模块时自定义webInject参数(函数)&lt;/h3&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; TokenApi = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; accessTokenApi(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    webInject:&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;html,token,callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; htmlEndIndex = html.indexOf(&lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;/html&amp;gt;&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; tokenScript = &lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;script&amp;gt;window.&#39;&lt;/span&gt; + &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.config.webTokenVarName + &lt;span class=&quot;string&quot;&gt;&#39;=&#39;&lt;/span&gt; + token + &lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;/script&amp;gt;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; prevHtml = html.substring(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,htmlEndIndex);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; nextHtml = html.substr(htmlEndIndex); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      prevHtml += tokenScript;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      prevHtml += nextHtml;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      callback(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;,prevHtml);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;项目地址&lt;a href=&quot;https://github.com/navyxie/access-token-api&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/navyxie/access-token-api&lt;/a&gt;,里面有express和sails框架的使用例子&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      a simple api access token support count and ttl,which base on nodejs.
    
    </summary>
    
      <category term="安全" scheme="http://www.navyxie.com/categories/%E5%AE%89%E5%85%A8/"/>
    
      <category term="api" scheme="http://www.navyxie.com/categories/%E5%AE%89%E5%85%A8/api/"/>
    
      <category term="Token" scheme="http://www.navyxie.com/categories/%E5%AE%89%E5%85%A8/api/Token/"/>
    
      <category term="access" scheme="http://www.navyxie.com/categories/%E5%AE%89%E5%85%A8/api/Token/access/"/>
    
    
      <category term="安全" scheme="http://www.navyxie.com/tags/%E5%AE%89%E5%85%A8/"/>
    
      <category term="Toekn" scheme="http://www.navyxie.com/tags/Toekn/"/>
    
      <category term="api" scheme="http://www.navyxie.com/tags/api/"/>
    
  </entry>
  
  <entry>
    <title>custom_weixin_share_content</title>
    <link href="http://www.navyxie.com/2016/05/31/custom-weixin-share-content/"/>
    <id>http://www.navyxie.com/2016/05/31/custom-weixin-share-content/</id>
    <published>2016-05-31T07:35:05.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;如何在不接入微信API的情况下自定义分享内容（图片、链接、标题）&quot;&gt;&lt;a href=&quot;#如何在不接入微信API的情况下自定义分享内容（图片、链接、标题）&quot; class=&quot;headerlink&quot; title=&quot;如何在不接入微信API的情况下自定义分享内容（图片、链接、标题）&quot;&gt;&lt;/a&gt;如何在不接入微信API的情况下自定义分享内容（图片、链接、标题）&lt;/h2&gt;&lt;p&gt;1 设置分享title:动态改变document.title值即可:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.title = &lt;span class=&quot;string&quot;&gt;&#39;test&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;2 设置分享图片：在页面隐藏一张尺寸大于290*290的图（图片需要容器包裹，设置容器css属性display:none即可）:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;div style=&lt;span class=&quot;string&quot;&gt;&quot;display:none&quot;&lt;/span&gt;&amp;gt;&amp;lt;img src=&quot;share.jpg&quot; /&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;3 设置分享的链接：动态修改document.documentURI的值即可（safari下，document.documentURI为只读属性，可借助history.pushState ）&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//android:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.documentURI = &lt;span class=&quot;string&quot;&gt;&quot;http://www.navyxie.com&quot;&lt;/span&gt;；&lt;span class=&quot;comment&quot;&gt;//经测试wechat6.3.13版本下此方法已失效，可使用同下IOS的方法自定义。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//ios:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.history.pushState(&lt;span class=&quot;string&quot;&gt;&quot;weixin-share-url&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;weixinshare&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;http://www.navyxie.com&quot;&lt;/span&gt;);&lt;span class=&quot;comment&quot;&gt;//只可设置同域链接&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;具体的运行原理可以看 &lt;a href=&quot;https://github.com/navyxie/weixin_js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;微信Android SDK 中的 js&lt;/a&gt; 源码分析。&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      自定义微信分享内容
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>redis_lock</title>
    <link href="http://www.navyxie.com/2016/05/20/redis-lock/"/>
    <id>http://www.navyxie.com/2016/05/20/redis-lock/</id>
    <published>2016-05-20T06:42:14.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;p&gt;场景：使用node+mongo搭建web应用时，常常遇到并发问题导致创建一条数据的时候会同时创建多条。&lt;/p&gt;
&lt;p&gt;通过redis set 方法 配合 ‘NX’ 选项即可实现锁机制。&lt;/p&gt;
&lt;p&gt;主要的方法有三个：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#lock&quot;&gt;&lt;code&gt;lock(加锁)&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#unlock&quot;&gt;&lt;code&gt;unlock(解锁)&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#extend&quot;&gt;&lt;code&gt;extend(更改锁过期时间)&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&quot;lock&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Redlock.prototype.lock = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;resource,ttl,callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; self = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; _val = _random();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;resolve, reject&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; lock = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Lock(self, resource, _val);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    self.client.SET(resource,_val,&lt;span class=&quot;string&quot;&gt;&#39;EX&#39;&lt;/span&gt;,ttl,&lt;span class=&quot;string&quot;&gt;&#39;NX&#39;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err,data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!err &amp;amp;&amp;amp; data === &lt;span class=&quot;string&quot;&gt;&#39;OK&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; resolve(lock);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; err = err || &lt;span class=&quot;string&quot;&gt;&#39;resource: &#39;&lt;/span&gt;+resource+&lt;span class=&quot;string&quot;&gt;&#39; is locked.&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.emit(&lt;span class=&quot;string&quot;&gt;&#39;lockError&#39;&lt;/span&gt;, err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).asCallback(callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;a name=&quot;unlock&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Redlock.prototype.unlock = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;lock,callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; self = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;resolve, reject&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; lock !== &lt;span class=&quot;string&quot;&gt;&#39;object&#39;&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(&lt;span class=&quot;string&quot;&gt;&#39;unlockError:lock is not object.&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    self.client.GET(lock.resource,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err,data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!err &amp;amp;&amp;amp; data === lock.value)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.client.DEL(lock.resource,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(err)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.emit(&lt;span class=&quot;string&quot;&gt;&#39;unlockError&#39;&lt;/span&gt;,err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(&lt;span class=&quot;string&quot;&gt;&#39;unlockError:&#39;&lt;/span&gt;+err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; resolve(lock);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.emit(&lt;span class=&quot;string&quot;&gt;&#39;unlockError&#39;&lt;/span&gt;,err || &lt;span class=&quot;string&quot;&gt;&#39;resource:&#39;&lt;/span&gt; + lock.resource + &lt;span class=&quot;string&quot;&gt;&#39; unable to unlock.&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(&lt;span class=&quot;string&quot;&gt;&#39;unlockError:&#39;&lt;/span&gt; + err || (&lt;span class=&quot;string&quot;&gt;&#39;resource:&#39;&lt;/span&gt; + lock.resource + &lt;span class=&quot;string&quot;&gt;&#39; unable to unlock.&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).asCallback(callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a name=&quot;extend&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Redlock.prototype.extend = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;lock,ttl,callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; self = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;resolve, reject&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; lock !== &lt;span class=&quot;string&quot;&gt;&#39;object&#39;&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(&lt;span class=&quot;string&quot;&gt;&#39;unlockError:lock is not object.&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    self.client.GET(lock.resource,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err,data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!err &amp;amp;&amp;amp; data === lock.value)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.client.expire(lock.resource,ttl,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err,data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!err &amp;amp;&amp;amp; data === &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; resolve(lock);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.emit(&lt;span class=&quot;string&quot;&gt;&#39;extendError&#39;&lt;/span&gt;, err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(&lt;span class=&quot;string&quot;&gt;&#39;extendError:&#39;&lt;/span&gt;+err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          &amp;#125;          &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.emit(&lt;span class=&quot;string&quot;&gt;&#39;extendError&#39;&lt;/span&gt;, err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(&lt;span class=&quot;string&quot;&gt;&#39;extendError:&#39;&lt;/span&gt;+err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).asCallback(callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;用法&quot;&gt;&lt;a href=&quot;#用法&quot; class=&quot;headerlink&quot; title=&quot;用法&quot;&gt;&lt;/a&gt;用法&lt;/h2&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; client = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;redis&#39;&lt;/span&gt;).createClient(&lt;span class=&quot;string&quot;&gt;&#39;port&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;host&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; redlock = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; RedLock(client);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; lock;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;`callback`&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//lock&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redlock.lock(&lt;span class=&quot;string&quot;&gt;&#39;test-resource-lock&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err,lockInstance&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  lock = lockInstance;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  done(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//unlock&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redlock.unlock(lock,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err,data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  done(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;`promise`&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;redlock.lock(&lt;span class=&quot;string&quot;&gt;&#39;test-resource-lock-promise&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;).done(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;lock&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//todo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    redlock.unlock(lock);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;PS:支持callback and promise.&lt;/p&gt;
&lt;p&gt;实现比较简单，100行内，有兴趣的可以在 &lt;a href=&quot;https://github.com/navyxie/redlock-node&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这里https://github.com/navyxie/redlock-node&lt;/a&gt; 查看源码&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;场景：使用node+mongo搭建web应用时，常常遇到并发问题导致创建一条数据的时候会同时创建多条。&lt;/p&gt;
&lt;p&gt;通过redis set 方法 配合 ‘NX’ 选项即可实现锁机制。&lt;/p&gt;
&lt;p&gt;主要的方法有三个：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#lock&quot;&gt;&lt;code&gt;lock(加锁)&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#unlock&quot;&gt;&lt;code&gt;unlock(解锁)&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;#extend&quot;&gt;&lt;code&gt;extend(更改锁过期时间)&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&quot;lock&quot; /&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Redlock.prototype.lock = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;resource,ttl,callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; self = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; _val = _random();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;resolve, reject&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; lock = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Lock(self, resource, _val);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    self.client.SET(resource,_val,&lt;span class=&quot;string&quot;&gt;&#39;EX&#39;&lt;/span&gt;,ttl,&lt;span class=&quot;string&quot;&gt;&#39;NX&#39;&lt;/span&gt;,&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err,data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(!err &amp;amp;&amp;amp; data === &lt;span class=&quot;string&quot;&gt;&#39;OK&#39;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; resolve(lock);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; err = err || &lt;span class=&quot;string&quot;&gt;&#39;resource: &#39;&lt;/span&gt;+resource+&lt;span class=&quot;string&quot;&gt;&#39; is locked.&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.emit(&lt;span class=&quot;string&quot;&gt;&#39;lockError&#39;&lt;/span&gt;, err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; reject(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;).asCallback(callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="redis" scheme="http://www.navyxie.com/categories/redis/"/>
    
      <category term="lock" scheme="http://www.navyxie.com/categories/redis/lock/"/>
    
    
      <category term="nodejs" scheme="http://www.navyxie.com/tags/nodejs/"/>
    
      <category term="redis" scheme="http://www.navyxie.com/tags/redis/"/>
    
      <category term="lock" scheme="http://www.navyxie.com/tags/lock/"/>
    
  </entry>
  
  <entry>
    <title>weixin-js-sdk</title>
    <link href="http://www.navyxie.com/2016/05/05/weixin-js-sdk/"/>
    <id>http://www.navyxie.com/2016/05/05/weixin-js-sdk/</id>
    <published>2016-05-05T05:05:45.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;微信web开发者工具&quot;&gt;&lt;a href=&quot;#微信web开发者工具&quot; class=&quot;headerlink&quot; title=&quot;微信web开发者工具&quot;&gt;&lt;/a&gt;微信web开发者工具&lt;/h2&gt;&lt;p&gt;在调试js-sdk api showMenuItems 时存在bug，不按预期执行（本想只显示发送给朋友和分享到朋友圈选项，结果显示所有的选项），部署到真实环境是正常的。&lt;/p&gt;
&lt;p&gt;OS：MacBook Pro (10.11.4)&lt;br&gt;微信web开发者工具反馈:v0.5.0（升级到最新版v0.6.0同样存在这个问题）&lt;/p&gt;
&lt;h3 id=&quot;附图&quot;&gt;&lt;a href=&quot;#附图&quot; class=&quot;headerlink&quot; title=&quot;附图&quot;&gt;&lt;/a&gt;附图&lt;/h3&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;本想只显示发送给朋友和分享到朋友圈选项，结果显示所有的选项:&lt;br&gt;&lt;img src=&quot;images/wechat-js-sdk/share_dev.jpeg&quot; alt=&quot;微信web开发者工具显示效果图&quot;&gt;&lt;/p&gt;
&lt;p&gt;真实环境效果：&lt;br&gt;&lt;img src=&quot;images/wechat-js-sdk/share_prod.jpg&quot; alt=&quot;真实环境效果图&quot;&gt;&lt;/p&gt;
&lt;p&gt;前端js调用代码：&lt;br&gt;&lt;img src=&quot;images/wechat-js-sdk/call_code.png&quot; alt=&quot;前端js调用代码&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;微信web开发者工具&quot;&gt;&lt;a href=&quot;#微信web开发者工具&quot; class=&quot;headerlink&quot; title=&quot;微信web开发者工具&quot;&gt;&lt;/a&gt;微信web开发者工具&lt;/h2&gt;&lt;p&gt;在调试js-sdk api showMenuItems 时存在bug，不按预期执行（本想只显示发送给朋友和分享到朋友圈选项，结果显示所有的选项），部署到真实环境是正常的。&lt;/p&gt;
&lt;p&gt;OS：MacBook Pro (10.11.4)&lt;br&gt;微信web开发者工具反馈:v0.5.0（升级到最新版v0.6.0同样存在这个问题）&lt;/p&gt;
&lt;h3 id=&quot;附图&quot;&gt;&lt;a href=&quot;#附图&quot; class=&quot;headerlink&quot; title=&quot;附图&quot;&gt;&lt;/a&gt;附图&lt;/h3&gt;
    
    </summary>
    
    
      <category term="微信" scheme="http://www.navyxie.com/tags/%E5%BE%AE%E4%BF%A1/"/>
    
      <category term="工具" scheme="http://www.navyxie.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="js-sdk" scheme="http://www.navyxie.com/tags/js-sdk/"/>
    
  </entry>
  
  <entry>
    <title>haproxy-https-to-http</title>
    <link href="http://www.navyxie.com/2016/04/29/haproxy-https-to-http/"/>
    <id>http://www.navyxie.com/2016/04/29/haproxy-https-to-http/</id>
    <published>2016-04-28T18:20:17.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;haproxy-把https转发的时候变成了http&quot;&gt;&lt;a href=&quot;#haproxy-把https转发的时候变成了http&quot; class=&quot;headerlink&quot; title=&quot;haproxy 把https转发的时候变成了http&quot;&gt;&lt;/a&gt;haproxy 把https转发的时候变成了http&lt;/h2&gt;&lt;p&gt;今天接微信API的时候，发现一个很奇怪的问题，本地调试都ok,一旦部署到线上就出问题，后来经过仔细排查，发现我们网站用的是https,很奇怪，haproxy转发的时候会把https转化成http，这是bug吗？待续。&lt;/p&gt;
&lt;p&gt;后来证实，这不是haproxy的bug.是由于我们项目使用的是&lt;a href=&quot;https://nodejs.org/en/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nodejs&lt;/a&gt;的&lt;a href=&quot;http://sailsjs.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;sails&lt;/a&gt;框架导致的。&lt;/p&gt;
&lt;p&gt;使用express的nodejs应用程序，需要注意，使用代理服务器转发的时候，获取请求协议的时候正确的取值方法是req.headers[‘x-forwarded-proto’]，直接取值req.protocol取得值是http,在接入微信授权的时候，本地调试都正常，一旦部署到线上(https)，就会提示：&lt;code&gt;config: invalid signature&lt;/code&gt;。所以当接入微信API，本地调试一切正常，到线上(https)部署后发现不正常，就应当检查一下授权的地址协议是否正确。&lt;/p&gt;
&lt;h3 id=&quot;referrer&quot;&gt;&lt;a href=&quot;#referrer&quot; class=&quot;headerlink&quot; title=&quot;referrer:&quot;&gt;&lt;/a&gt;referrer:&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/nodejs/node-v0.x-archive/issues/6735&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/nodejs/node-v0.x-archive/issues/6735&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/expressjs/express/issues/1863&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/expressjs/express/issues/1863&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;haproxy-把https转发的时候变成了http&quot;&gt;&lt;a href=&quot;#haproxy-把https转发的时候变成了http&quot; class=&quot;headerlink&quot; title=&quot;haproxy 把https转发的时候变成了http&quot;&gt;&lt;/a&gt;haproxy 
    
    </summary>
    
    
      <category term="haproxy" scheme="http://www.navyxie.com/tags/haproxy/"/>
    
      <category term="https" scheme="http://www.navyxie.com/tags/https/"/>
    
      <category term="http" scheme="http://www.navyxie.com/tags/http/"/>
    
      <category term="微信" scheme="http://www.navyxie.com/tags/%E5%BE%AE%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>image-preload</title>
    <link href="http://www.navyxie.com/2016/04/27/image-preload/"/>
    <id>http://www.navyxie.com/2016/04/27/image-preload/</id>
    <published>2016-04-27T15:08:37.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;图片预加载——显示加载进度&quot;&gt;&lt;a href=&quot;#图片预加载——显示加载进度&quot; class=&quot;headerlink&quot; title=&quot;图片预加载——显示加载进度&quot;&gt;&lt;/a&gt;图片预加载——显示加载进度&lt;/h2&gt;&lt;h3 id=&quot;usage&quot;&gt;&lt;a href=&quot;#usage&quot; class=&quot;headerlink&quot; title=&quot;usage&quot;&gt;&lt;/a&gt;usage&lt;/h3&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@param imageArr:预先加载的图片数组,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@param config:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  @param update:每加载一张执行一次update函数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  @param complete:加载完成所有图片执行该函数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  @param silent:true//表示使用默认的加载样式&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ImageLoader(imageArr,config)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;ng-app&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;app&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;imageloader&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;title&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;../imageloader.js&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;undefined&quot;&gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;link&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;rel&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text/css&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;../imageloader.css&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;head&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;h2&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text-align:center&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;imageloader demo&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;h2&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;imageContainer&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;javascript&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; imagesArr = [&lt;span class=&quot;string&quot;&gt;&#39;./images/buy_domain.png&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;./images/dusk.jpg&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;./images/malaysia_dusk.jpg&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;./images/malaysia_sea.jpg&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; updateFn = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; img = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.createElement(&lt;span class=&quot;string&quot;&gt;&#39;IMG&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        img.setAttribute(&lt;span class=&quot;string&quot;&gt;&#39;src&#39;&lt;/span&gt;,&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;string&quot;&gt;&#39;imageContainer&#39;&lt;/span&gt;).appendChild(img);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      ImageLoader(imagesArr,&amp;#123;update:updateFn,complete:&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        alert(&lt;span class=&quot;string&quot;&gt;&#39;All images loaded.&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;,silent:&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;html&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/navyxie/imageloader&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;源码地址：https://github.com/navyxie/imageloader&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      图片预加载
    
    </summary>
    
    
      <category term="工具" scheme="http://www.navyxie.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="加载" scheme="http://www.navyxie.com/tags/%E5%8A%A0%E8%BD%BD/"/>
    
  </entry>
  
  <entry>
    <title>mobile_fix</title>
    <link href="http://www.navyxie.com/2016/04/22/mobile-fix/"/>
    <id>http://www.navyxie.com/2016/04/22/mobile-fix/</id>
    <published>2016-04-21T17:32:18.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;像图片一样布局&quot;&gt;&lt;a href=&quot;#像图片一样布局&quot; class=&quot;headerlink&quot; title=&quot;像图片一样布局&quot;&gt;&lt;/a&gt;像图片一样布局&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/xiangpaopao/blog/issues/9&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/xiangpaopao/blog/issues/9&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/peunzhang/pageResponse&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/peunzhang/pageResponse&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;单页，单屏切换&quot;&gt;&lt;a href=&quot;#单页，单屏切换&quot; class=&quot;headerlink&quot; title=&quot;单页，单屏切换&quot;&gt;&lt;/a&gt;单页，单屏切换&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/powy1993/fullpage&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/powy1993/fullpage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/thebird/Swipe&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/thebird/Swipe&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;打字效果&quot;&gt;&lt;a href=&quot;#打字效果&quot; class=&quot;headerlink&quot; title=&quot;打字效果&quot;&gt;&lt;/a&gt;打字效果&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://coffeedeveloper.github.io/typing.js/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://coffeedeveloper.github.io/typing.js/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/mattboldt/typed.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/mattboldt/typed.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;动画&quot;&gt;&lt;a href=&quot;#动画&quot; class=&quot;headerlink&quot; title=&quot;动画&quot;&gt;&lt;/a&gt;动画&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/daneden/animate.css&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/daneden/animate.css&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;像图片一样布局&quot;&gt;&lt;a href=&quot;#像图片一样布局&quot; class=&quot;headerlink&quot; title=&quot;像图片一样布局&quot;&gt;&lt;/a&gt;像图片一样布局&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/xiangpaopao/blog
    
    </summary>
    
      <category term="移动端" scheme="http://www.navyxie.com/categories/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
    
      <category term="移动端" scheme="http://www.navyxie.com/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/"/>
    
      <category term="适配" scheme="http://www.navyxie.com/tags/%E9%80%82%E9%85%8D/"/>
    
      <category term="单页" scheme="http://www.navyxie.com/tags/%E5%8D%95%E9%A1%B5/"/>
    
      <category term="singlepage" scheme="http://www.navyxie.com/tags/singlepage/"/>
    
      <category term="fullpage" scheme="http://www.navyxie.com/tags/fullpage/"/>
    
  </entry>
  
  <entry>
    <title>web-security</title>
    <link href="http://www.navyxie.com/2016/04/19/web-security/"/>
    <id>http://www.navyxie.com/2016/04/19/web-security/</id>
    <published>2016-04-18T21:18:50.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;随机token&quot;&gt;&lt;a href=&quot;#随机token&quot; class=&quot;headerlink&quot; title=&quot;随机token&quot;&gt;&lt;/a&gt;随机token&lt;/h2&gt;&lt;p&gt;整个处理流程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在需要处理盗刷的接口添加token参数校验&lt;/li&gt;
&lt;li&gt;web端在需要处理盗刷页面注入token&lt;/li&gt;
&lt;li&gt;Native(IOS,android)通过API形式请求token，在相应的接口请求时带上&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;服务端生成token&quot;&gt;&lt;a href=&quot;#服务端生成token&quot; class=&quot;headerlink&quot; title=&quot;服务端生成token&quot;&gt;&lt;/a&gt;服务端生成token&lt;/h3&gt;&lt;p&gt;使用redis管理token&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;//生成token&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Redis.SETEX(token,ttl, 1,cb);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//验证token&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Redis.GET(token,function (err, data) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    if(data &amp;amp;&amp;amp; data &amp;lt; 4)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      //每个token在ttl时间间隔内只能使用3次&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      self.incrToken(token,tokenPre,cb);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;else&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      self.removeToken(token,tokenPre,function(err,data)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cb(null,false);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;web端在render前注入token以及script脚本以便获取token值&quot;&gt;&lt;a href=&quot;#web端在render前注入token以及script脚本以便获取token值&quot; class=&quot;headerlink&quot; title=&quot;web端在render前注入token以及script脚本以便获取token值&quot;&gt;&lt;/a&gt;web端在render前注入token以及script脚本以便获取token值&lt;/h3&gt;&lt;p&gt;token值切分成每个字符插入到HTML dom 中&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var bodyEndStr = &amp;apos;&amp;lt;/body&amp;gt;&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var bodyStartStr = &amp;apos;&amp;lt;body&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var token = &amp;apos;后端生成的token&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var tokenId = &amp;apos;_&amp;apos; + FN_UTIL.generateSalt(Math.ceil(Math.random()*10));//随机生成字符数字字符串作为dom id，为了避免第一个字符是数字，所以添加了前缀_&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var bodyStarIndex = html.indexOf(bodyStartStr);//body标签开启位置&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var bodyEndIndex = html.indexOf(bodyEndStr);//body标签结束位置&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var htmlTagLastIndexs = FN_UTIL.matchHtmlTags(html.substring(bodyStarIndex,bodyEndIndex+1));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var htmlTagLen = htmlTagLastIndexs.length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var tokenLen = token.length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var times = Math.floor(htmlTagLen/tokenLen);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var randomIndex = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var addLen = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var scriptStr = &amp;apos;var r=&amp;quot;&amp;quot;;function g(id)&amp;#123;return document.getElementById(id).innerHTML&amp;#125;&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;for(var i = 0 ; i &amp;lt; tokenLen ; i++)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  var htmlTag = FN_UTIL.makeHtmlTag(tokenId+i,token[i]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  randomIndex += Math.floor(Math.random()*times);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  if(!htmlTagLastIndexs[randomIndex])&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    randomIndex = htmlTagLen - 1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  var curIndex = bodyStarIndex+htmlTagLastIndexs[randomIndex]+addLen;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  var prevHtml = html.substring(0,curIndex);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  var nextHtml = html.substr(curIndex); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  scriptStr += &amp;apos;r += g(&amp;quot;&amp;apos;+(tokenId+i)+&amp;apos;&amp;quot;);&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  if(i === tokenLen-1)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    scriptStr += &amp;apos;w.xxx=r;&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    html = prevHtml.concat(htmlTag,&amp;apos;&amp;lt;script&amp;gt;(function(w)&amp;#123;&amp;apos;+scriptStr+&amp;apos;&amp;#125;)(window)&amp;lt;/script&amp;gt;&amp;apos;,nextHtml);//执行js获取token值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;else&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    html = prevHtml.concat(htmlTag,nextHtml);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  addLen += htmlTag.length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;FN_UTIL 的代码：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;var SALTCHARS = &amp;apos;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var htmlTags = [&amp;apos;b&amp;apos;,&amp;apos;big&amp;apos;,&amp;apos;i&amp;apos;,&amp;apos;small&amp;apos;,&amp;apos;tt&amp;apos;,&amp;apos;abbr&amp;apos;,&amp;apos;acronym&amp;apos;,&amp;apos;cite&amp;apos;,&amp;apos;code&amp;apos;,&amp;apos;dfn&amp;apos;,&amp;apos;em&amp;apos;,&amp;apos;kbd&amp;apos;,&amp;apos;strong&amp;apos;,&amp;apos;samp&amp;apos;,&amp;apos;time&amp;apos;,&amp;apos;bdo&amp;apos;,&amp;apos;map&amp;apos;,&amp;apos;q&amp;apos;,&amp;apos;span&amp;apos;,&amp;apos;sub&amp;apos;,&amp;apos;sup&amp;apos;,&amp;apos;button&amp;apos;,&amp;apos;label&amp;apos;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;module.exports = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  generateSalt:function(length)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var i, r = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for (i = 0; i &amp;lt; length; ++i) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      r.push(SALTCHARS[Math.floor(Math.random() * SALTCHARS.length)]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return r.join(&amp;apos;&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  matchHtmlTags:function(html)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var reg = new RegExp(/&amp;lt;\/[^&amp;gt;]+&amp;gt;/gim);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var lastIndexs = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    while((result = reg.exec(html)) != null)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      lastIndexs.push(reg.lastIndex);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return lastIndexs;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  makeHtmlTag:function(id,val)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    var tag = this.randomHtmlTagName();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return &amp;apos;&amp;lt;&amp;apos;+tag+&amp;apos; id=&amp;quot;&amp;apos;+id+&amp;apos;&amp;quot; style=&amp;quot;display:none;&amp;quot;&amp;gt;&amp;apos; + val + &amp;apos;&amp;lt;/&amp;apos;+tag+&amp;apos;&amp;gt;&amp;apos;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  randomHtmlTagName:function()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return htmlTags[Math.floor(Math.random()*htmlTags.length)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Native-IOS-Android-端&quot;&gt;&lt;a href=&quot;#Native-IOS-Android-端&quot; class=&quot;headerlink&quot; title=&quot;Native(IOS,Android)端&quot;&gt;&lt;/a&gt;Native(IOS,Android)端&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;//获取服务器端的时间戳&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var serverTime = getServerTime();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//使用对称加密算法加密特定字符串和时间戳&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;var encodeData = crypto.encode(&amp;apos;xxxx_time&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;//服务器端解密加密数据，提取时间戳，与server时间戳对比，在一定差值(10s)内允许生成token，客户端通过token，执行后续操作&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;优点&quot;&gt;&lt;a href=&quot;#优点&quot; class=&quot;headerlink&quot; title=&quot;优点&quot;&gt;&lt;/a&gt;优点&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;整个防盗流程都是技术手段在处理，对用户透明，既起到一定的安全防护又不失用户体验&lt;/li&gt;
&lt;li&gt;Native端通过加密获取token，即使获取token的接口被监听，有时间戳校验，也是在很大程度上防止盗刷&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;注意，随机的标签不能是块级元素，不然原本块级元素内包含内联元素，嵌入块级元素后会导致元素布局错乱.内联元素列表参照&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTML/Inline_elements&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/HTML/Inline_elements&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      不用验证码的防盗刷方式
    
    </summary>
    
      <category term="安全" scheme="http://www.navyxie.com/categories/%E5%AE%89%E5%85%A8/"/>
    
      <category term="验证" scheme="http://www.navyxie.com/categories/%E5%AE%89%E5%85%A8/%E9%AA%8C%E8%AF%81/"/>
    
    
      <category term="api" scheme="http://www.navyxie.com/tags/api/"/>
    
      <category term="web" scheme="http://www.navyxie.com/tags/web/"/>
    
      <category term="security" scheme="http://www.navyxie.com/tags/security/"/>
    
      <category term="盗刷" scheme="http://www.navyxie.com/tags/%E7%9B%97%E5%88%B7/"/>
    
      <category term="验证码" scheme="http://www.navyxie.com/tags/%E9%AA%8C%E8%AF%81%E7%A0%81/"/>
    
      <category term="加密" scheme="http://www.navyxie.com/tags/%E5%8A%A0%E5%AF%86/"/>
    
      <category term="解密" scheme="http://www.navyxie.com/tags/%E8%A7%A3%E5%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>watch-ENOSPC</title>
    <link href="http://www.navyxie.com/2016/04/18/watch-ENOSPC/"/>
    <id>http://www.navyxie.com/2016/04/18/watch-ENOSPC/</id>
    <published>2016-04-18T08:44:36.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Node-JS-Error-ENOSPC-ENOSPC-Error-No-space-left-on-device&quot;&gt;&lt;a href=&quot;#Node-JS-Error-ENOSPC-ENOSPC-Error-No-space-left-on-device&quot; class=&quot;headerlink&quot; title=&quot;Node.JS Error: ENOSPC (ENOSPC:Error No space left on device)&quot;&gt;&lt;/a&gt;Node.JS Error: ENOSPC (ENOSPC:Error No space left on device)&lt;/h2&gt;&lt;h3 id=&quot;Run-the-below-command&quot;&gt;&lt;a href=&quot;#Run-the-below-command&quot; class=&quot;headerlink&quot; title=&quot;Run the below command:&quot;&gt;&lt;/a&gt;Run the below command:&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;amp;&amp;amp; sudo sysctl -p&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;The system has a limit to how many files can be watched by a user. You can run out of watches pretty quickly if you have Grunt running with other programs like Dropbox. This command increases the maximum amount of watches a user can have.&lt;/em&gt;&lt;/p&gt;
&lt;h4 id=&quot;referrer&quot;&gt;&lt;a href=&quot;#referrer&quot; class=&quot;headerlink&quot; title=&quot;referrer&quot;&gt;&lt;/a&gt;referrer&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/16748737/grunt-watch-error-waiting-fatal-error-watch-enospc&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://stackoverflow.com/questions/16748737/grunt-watch-error-waiting-fatal-error-watch-enospc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://wiki.archlinux.org/index.php/Sysctl&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://wiki.archlinux.org/index.php/Sysctl&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      Node.JS Error: ENOSPC
    
    </summary>
    
      <category term="系统" scheme="http://www.navyxie.com/categories/%E7%B3%BB%E7%BB%9F/"/>
    
    
      <category term="watch" scheme="http://www.navyxie.com/tags/watch/"/>
    
      <category term="ENOSPC" scheme="http://www.navyxie.com/tags/ENOSPC/"/>
    
  </entry>
  
  <entry>
    <title>mac-pow</title>
    <link href="http://www.navyxie.com/2016/04/17/mac-pow/"/>
    <id>http://www.navyxie.com/2016/04/17/mac-pow/</id>
    <published>2016-04-16T21:37:11.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;http://pow.cx/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;pow is a zero-config Rack server for Mac OS X&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;install&quot;&gt;&lt;a href=&quot;#install&quot; class=&quot;headerlink&quot; title=&quot;install&quot;&gt;&lt;/a&gt;install&lt;/h2&gt;&lt;h3 id=&quot;curl-get-pow-cx-sh&quot;&gt;&lt;a href=&quot;#curl-get-pow-cx-sh&quot; class=&quot;headerlink&quot; title=&quot;curl get.pow.cx | sh&quot;&gt;&lt;/a&gt;curl get.pow.cx | sh&lt;/h3&gt;&lt;p&gt;&lt;em&gt;install log info:&lt;/em&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                 Dload  Upload   Total   Spent    Left  Speed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100  9039  100  9039    0     0   3396      0  0:00:02  0:00:02 --:--:--  3395&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installing Pow 0.5.0...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installing local configuration files...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/Users/Navy/Library/LaunchAgents/cx.pow.powd.plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installing system configuration files as root...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Password:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/etc/resolver/dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/Library/LaunchDaemons/cx.pow.firewall.plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Starting the Pow server...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Performing self-test...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;For troubleshooting instructions, please see the Pow wiki:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/basecamp/pow/wiki/Troubleshooting&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;To uninstall Pow, `curl get.pow.cx/uninstall.sh | sh`&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Serving-Static-Files&quot;&gt;&lt;a href=&quot;#Serving-Static-Files&quot; class=&quot;headerlink&quot; title=&quot;Serving Static Files&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://pow.cx/manual.html#section_2.4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Serving Static Files&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Pow automatically serves static files in the public directory of your application. It’s possible to serve a completely static site without a config.ru file as long as it has a public directory. If you have a static site and want to keep your files in the root of your project (i.e. not in a public directory), you can do the following:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ cd ~/.pow&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ mkdir your-app-domain&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ cd !$&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ln -s ~/Projects/your-app public&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Accessing-Virtual-Hosts-from-Other-Computers&quot;&gt;&lt;a href=&quot;#Accessing-Virtual-Hosts-from-Other-Computers&quot; class=&quot;headerlink&quot; title=&quot;Accessing Virtual Hosts from Other Computers&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://pow.cx/manual.html#section_2.1&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Accessing Virtual Hosts from Other Computers&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Sometimes you need to access your Pow virtual hosts from another computer on your local network — for example, when testing your application on a mobile device or from a Windows or Linux VM.&lt;/p&gt;
&lt;p&gt;The .dev domain will only work on your development computer. However, you can use the special .xip.io domain to remotely access your Pow virtual hosts.&lt;/p&gt;
&lt;p&gt;Construct your xip.io domain by appending your application’s name to your LAN IP address followed by .xip.io. For example, if your development computer’s LAN IP address is 10.0.1.43, you can visit myapp.dev from another computer on your local network using the URL &lt;a href=&quot;http://myapp.10.0.1.43.xip.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://myapp.10.0.1.43.xip.io/&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;Port-Proxying&quot;&gt;&lt;a href=&quot;#Port-Proxying&quot; class=&quot;headerlink&quot; title=&quot;Port Proxying&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://pow.cx/manual.html#section_2.1.4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Port Proxying&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Pow’s port proxying feature lets you route all web traffic on a particular hostname to another port or IP address. To use it, just create a file in &lt;code&gt;~/.pow&lt;/code&gt; (instead of a symlink) with the destination port number as its contents.&lt;/p&gt;
&lt;p&gt;For example, to forward all traffic for &lt;code&gt;http://proxiedapp.dev/&lt;/code&gt; to port 8080 on your localhost:&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;echo http://1.2.3.4:8080 &amp;gt; ~/.pow/proxiedapp&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;You can also use port proxying to access web apps written for other runtimes such as Python or Node.js. Remember that services behind the proxy won’t automatically be started or stopped like Rack apps.&lt;/p&gt;
&lt;h2 id=&quot;Subdomains&quot;&gt;&lt;a href=&quot;#Subdomains&quot; class=&quot;headerlink&quot; title=&quot;Subdomains&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://pow.cx/manual.html#section_3.3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Subdomains&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Once a virtual host is installed, it’s also automatically accessible from all subdomains of the named host. For example, the &lt;code&gt;myapp&lt;/code&gt; virtual host described above could also be accessed at &lt;code&gt;http://www.myapp.dev/&lt;/code&gt; and &lt;code&gt;http://assets.www.myapp.dev/&lt;/code&gt;. You can override this behavior to, say, point &lt;code&gt;www.myapp.dev&lt;/code&gt; to a different application — just create another virtual host symlink named &lt;code&gt;www.myapp&lt;/code&gt; for the application you want.&lt;/p&gt;
&lt;h2 id=&quot;start-or-stop-pow&quot;&gt;&lt;a href=&quot;#start-or-stop-pow&quot; class=&quot;headerlink&quot; title=&quot;start or stop pow&quot;&gt;&lt;/a&gt;start or stop pow&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;command line:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;stop Pow:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;launchctl unload ~/Library/LaunchAgents/cx.pow.powd.plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo launchctl unload ~/Library/LaunchDaemons/cx.pow.firewall.plist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;start Pow:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;launchctl load ~/Library/LaunchAgents/cx.pow.powd.plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sudo launchctl load ~/Library/LaunchDaemons/cx.pow.firewall.plist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;It’s a lot easier, though, to use third-party tools like &lt;a href=&quot;https://github.com/rodreegez/powder&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;powder&lt;/a&gt; or &lt;a href=&quot;https://github.com/sethvargo/powify&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;powify&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Powder:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# Stop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;powder down #or&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;powder stop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# Start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;powder up #or&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;powder start&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Powify:&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# Stop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;powify server stop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# Start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;powify server start&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;Viewing-Log-Files&quot;&gt;&lt;a href=&quot;#Viewing-Log-Files&quot; class=&quot;headerlink&quot; title=&quot;Viewing Log Files&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://pow.cx/manual.html#section_2.6&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Viewing Log Files&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Pow stores log files in the &lt;code&gt;~/Library/Logs/Pow directory&lt;/code&gt; so they can be viewed easily with OS X’s Console application. Each incoming request URL is logged, along with its hostname and HTTP method, in the &lt;code&gt;access.log&lt;/code&gt; file. The stdout and stderr streams for each worker process are captured and logged to the &lt;code&gt;apps&lt;/code&gt; directory in a file matching the name of the application.&lt;/p&gt;
&lt;p&gt;Note: Rails logger output does not appear in Pow’s logs. You’ll want to tail -f &lt;code&gt;log/development.log&lt;/code&gt; to see those entries.&lt;/p&gt;
&lt;h4 id=&quot;pow-docs-http-pow-cx-manual-html&quot;&gt;&lt;a href=&quot;#pow-docs-http-pow-cx-manual-html&quot; class=&quot;headerlink&quot; title=&quot;pow docs : http://pow.cx/manual.html&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://pow.cx/manual.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;pow docs&lt;/a&gt; : &lt;a href=&quot;http://pow.cx/manual.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://pow.cx/manual.html&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;PS: Pow changed some file in /etc/ on installation. when php application occure 404 , should uninstalled this.&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;http://pow.cx/&quot;&gt;pow is a zero-config Rack server for Mac OS X&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;install&quot;&gt;&lt;a href=&quot;#install&quot; class=&quot;headerlink&quot; title=&quot;install&quot;&gt;&lt;/a&gt;install&lt;/h2&gt;&lt;h3 id=&quot;curl-get-pow-cx-sh&quot;&gt;&lt;a href=&quot;#curl-get-pow-cx-sh&quot; class=&quot;headerlink&quot; title=&quot;curl get.pow.cx | sh&quot;&gt;&lt;/a&gt;curl get.pow.cx | sh&lt;/h3&gt;&lt;p&gt;&lt;em&gt;install log info:&lt;/em&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                                 Dload  Upload   Total   Spent    Left  Speed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100  9039  100  9039    0     0   3396      0  0:00:02  0:00:02 --:--:--  3395&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installing Pow 0.5.0...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installing local configuration files...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/Users/Navy/Library/LaunchAgents/cx.pow.powd.plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installing system configuration files as root...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Password:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/etc/resolver/dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/Library/LaunchDaemons/cx.pow.firewall.plist&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Starting the Pow server...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Performing self-test...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*** Installed&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;For troubleshooting instructions, please see the Pow wiki:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;https://github.com/basecamp/pow/wiki/Troubleshooting&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;To uninstall Pow, `curl get.pow.cx/uninstall.sh | sh`&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="software" scheme="http://www.navyxie.com/categories/software/"/>
    
    
      <category term="mac" scheme="http://www.navyxie.com/tags/mac/"/>
    
      <category term="pow" scheme="http://www.navyxie.com/tags/pow/"/>
    
  </entry>
  
  <entry>
    <title>hexo-theme-landscape-swiftype</title>
    <link href="http://www.navyxie.com/2016/04/16/hexo-theme-landscape-swiftype/"/>
    <id>http://www.navyxie.com/2016/04/16/hexo-theme-landscape-swiftype/</id>
    <published>2016-04-15T22:16:04.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;hexo站内搜索功能-——-swiftype&quot;&gt;&lt;a href=&quot;#hexo站内搜索功能-——-swiftype&quot; class=&quot;headerlink&quot; title=&quot;hexo站内搜索功能 —— swiftype&quot;&gt;&lt;/a&gt;hexo站内搜索功能 —— swiftype&lt;/h2&gt;&lt;p&gt;hexo 默认自带的搜索引擎是google,我们接下来是讲解如何用swiftype实现站内搜索&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;去&lt;a href=&quot;https://swiftype.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;swiftype&lt;/a&gt;官网注册一个账号，按步骤同步站点内容，然后复制代码，代码如下：&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script type=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;w,d,t,u,n,s,e&lt;/span&gt;)&lt;/span&gt;&amp;#123;w[&lt;span class=&quot;string&quot;&gt;&#39;SwiftypeObject&#39;&lt;/span&gt;]=n;w[n]=w[n]||&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  (w[n].q=w[n].q||[]).push(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;);&amp;#125;;s=d.createElement(t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  e=d.getElementsByTagName(t)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];s.async=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;s.src=u;e.parentNode.insertBefore(s,e);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)(&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;,&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;script&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;//s.swiftypecdn.com/install/v2/st.js&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;_st&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  _st(&lt;span class=&quot;string&quot;&gt;&#39;install&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;kWSKry9NQXF2ddPp_Lay&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;2.0.0&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//请更换自己的kWSKry9NQXF2ddPp_Lay&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ol&gt;
&lt;li&gt;搜索主题的search_form方法，不同主题可能位置不一样，但是landscape主题是在layout/_partial/header.ejs文件中，替换掉search_form方法，如下：&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;div id=&lt;span class=&quot;string&quot;&gt;&quot;search-form-wrap&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;st-default-search-input search-form-input&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;style&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;outline: none;width: 110px;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script type=&lt;span class=&quot;string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;w,d,t,u,n,s,e&lt;/span&gt;)&lt;/span&gt;&amp;#123;w[&lt;span class=&quot;string&quot;&gt;&#39;SwiftypeObject&#39;&lt;/span&gt;]=n;w[n]=w[n]||&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  (w[n].q=w[n].q||[]).push(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;);&amp;#125;;s=d.createElement(t);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  e=d.getElementsByTagName(t)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;];s.async=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;s.src=u;e.parentNode.insertBefore(s,e);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;)(&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;,&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;script&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;//s.swiftypecdn.com/install/v2/st.js&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;_st&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  _st(&lt;span class=&quot;string&quot;&gt;&#39;install&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;kWSKry9NQXF2ddPp_Lay&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;2.0.0&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;可参照本博客&lt;a href=&quot;https://github.com/navyxie/hexo-github-page&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;源码&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      hexo theme landscape add swiftype
    
    </summary>
    
      <category term="hexo" scheme="http://www.navyxie.com/categories/hexo/"/>
    
      <category term="theme" scheme="http://www.navyxie.com/categories/hexo/theme/"/>
    
      <category term="landscape" scheme="http://www.navyxie.com/categories/hexo/theme/landscape/"/>
    
    
      <category term="hexo" scheme="http://www.navyxie.com/tags/hexo/"/>
    
      <category term="theme" scheme="http://www.navyxie.com/tags/theme/"/>
    
      <category term="landscape" scheme="http://www.navyxie.com/tags/landscape/"/>
    
      <category term="swiftype" scheme="http://www.navyxie.com/tags/swiftype/"/>
    
  </entry>
  
  <entry>
    <title>hexo-them-landscape</title>
    <link href="http://www.navyxie.com/2016/04/16/hexo-them-landscape/"/>
    <id>http://www.navyxie.com/2016/04/16/hexo-them-landscape/</id>
    <published>2016-04-15T22:06:28.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;hexo-theme-landscape-0-0-1-版本文章分页显示的bug&quot;&gt;&lt;a href=&quot;#hexo-theme-landscape-0-0-1-版本文章分页显示的bug&quot; class=&quot;headerlink&quot; title=&quot;hexo-theme-landscape  0.0.1 版本文章分页显示的bug&quot;&gt;&lt;/a&gt;hexo-theme-landscape  0.0.1 版本文章分页显示的bug&lt;/h2&gt;&lt;p&gt;上一页和下一页的bug显示如下：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;« __(&#39;prev&#39;) __(&#39;next&#39;) »&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;解决方法(layout/_partial/archive.ejs)：&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;nav id=&lt;span class=&quot;string&quot;&gt;&quot;page-nav&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;prev_text&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;&amp;amp;laquo; &quot;&lt;/span&gt; + &lt;span class=&quot;attr&quot;&gt;__&lt;/span&gt;(&#39;&lt;span class=&quot;attr&quot;&gt;prev&lt;/span&gt;&#39;);&lt;span class=&quot;attr&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;next_text&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;__(&lt;/span&gt;&#39;&lt;span class=&quot;attr&quot;&gt;next&lt;/span&gt;&#39;) + &quot; &amp;amp;&lt;span class=&quot;attr&quot;&gt;raquo&lt;/span&gt;;&quot;%&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;%-&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;paginator&lt;/span&gt;(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;attr&quot;&gt;prev_text:&lt;/span&gt; &quot;&amp;amp;&lt;span class=&quot;attr&quot;&gt;laquo&lt;/span&gt;; &quot;+&lt;span class=&quot;attr&quot;&gt;__&lt;/span&gt;(&#39;&lt;span class=&quot;attr&quot;&gt;prev&lt;/span&gt;&#39;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;attr&quot;&gt;next_text:&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;__&lt;/span&gt;(&#39;&lt;span class=&quot;attr&quot;&gt;next&lt;/span&gt;&#39;)+&quot; &amp;amp;&lt;span class=&quot;attr&quot;&gt;raquo&lt;/span&gt;;&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;attr&quot;&gt;prev_text:&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;prev_text&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;attr&quot;&gt;next_text:&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;next_text&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;) %&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;nav&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;已向官方提交&lt;a href=&quot;https://github.com/hexojs/hexo-theme-landscape/pull/67/files&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PR&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      hexo landscape theme
    
    </summary>
    
      <category term="hexo" scheme="http://www.navyxie.com/categories/hexo/"/>
    
      <category term="theme" scheme="http://www.navyxie.com/categories/hexo/theme/"/>
    
      <category term="landscape" scheme="http://www.navyxie.com/categories/hexo/theme/landscape/"/>
    
    
      <category term="hexo" scheme="http://www.navyxie.com/tags/hexo/"/>
    
      <category term="theme" scheme="http://www.navyxie.com/tags/theme/"/>
    
      <category term="landscape" scheme="http://www.navyxie.com/tags/landscape/"/>
    
  </entry>
  
  <entry>
    <title>mongo_aggregate_cond</title>
    <link href="http://www.navyxie.com/2016/04/16/mongo-aggregate-cond/"/>
    <id>http://www.navyxie.com/2016/04/16/mongo-aggregate-cond/</id>
    <published>2016-04-15T18:24:19.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;mongo按条件返回字段值&quot;&gt;&lt;a href=&quot;#mongo按条件返回字段值&quot; class=&quot;headerlink&quot; title=&quot;mongo按条件返回字段值&quot;&gt;&lt;/a&gt;mongo按条件返回字段值&lt;/h2&gt;&lt;p&gt;假设数据库表inventory中的数据如下：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;_id&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;item&quot;&lt;/span&gt; : &lt;span class=&quot;string&quot;&gt;&quot;abc1&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;discount&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;_id&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;item&quot;&lt;/span&gt; : &lt;span class=&quot;string&quot;&gt;&quot;abc2&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;discount&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;_id&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;item&quot;&lt;/span&gt; : &lt;span class=&quot;string&quot;&gt;&quot;xyz1&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;discount&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;执行aggregate操作：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;db.inventory.aggregate(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         $project:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             item: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             discount:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 $cond: &amp;#123; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;: &amp;#123; $gte: [ &lt;span class=&quot;string&quot;&gt;&quot;$qty&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt; ] &amp;#125;, then: &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或者&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;db.inventory.aggregate(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         $project:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             item: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;             discount:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 $cond: [ &amp;#123; $gte: [ &lt;span class=&quot;string&quot;&gt;&quot;$qty&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt; ] &amp;#125;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;               &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;返回结果：&lt;/p&gt;
&lt;p&gt;{ “_id” : 1, “item” : “abc1”, “discount” : 30 }&lt;br&gt;{ “_id” : 2, “item” : “abc2”, “discount” : 20 }&lt;br&gt;{ “_id” : 3, “item” : “xyz1”, “discount” : 30 }&lt;/p&gt;
</content>
    
    <summary type="html">
    
      mongo aggregate cond
    
    </summary>
    
      <category term="数据库" scheme="http://www.navyxie.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="mongo" scheme="http://www.navyxie.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mongo/"/>
    
    
      <category term="mongo" scheme="http://www.navyxie.com/tags/mongo/"/>
    
      <category term="数据库" scheme="http://www.navyxie.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="aggregate" scheme="http://www.navyxie.com/tags/aggregate/"/>
    
  </entry>
  
  <entry>
    <title>mongo</title>
    <link href="http://www.navyxie.com/2016/04/15/mongo/"/>
    <id>http://www.navyxie.com/2016/04/15/mongo/</id>
    <published>2016-04-14T17:43:05.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;mongodb-的-aggregate-操作&quot;&gt;&lt;a href=&quot;#mongodb-的-aggregate-操作&quot; class=&quot;headerlink&quot; title=&quot;mongodb 的 aggregate 操作&quot;&gt;&lt;/a&gt;mongodb 的 aggregate 操作&lt;/h2&gt;&lt;p&gt;当我们对数据按日期进行分组时，经常遇到ISO日期格式比北京时间小8个小时的问题，导致数据分组时，存在跨天的问题，一组数据如下&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/* 1 */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;amount&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;oType&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;status&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;createdAt&quot;&lt;/span&gt; : ISODate(&lt;span class=&quot;string&quot;&gt;&quot;2015-02-01T18:16:23.133Z&quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;updatedAt&quot;&lt;/span&gt; : ISODate(&lt;span class=&quot;string&quot;&gt;&quot;2015-02-02T10:29:01.463Z&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/* 2 */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;amount&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;oType&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;status&quot;&lt;/span&gt; : &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;createdAt&quot;&lt;/span&gt; : ISODate(&lt;span class=&quot;string&quot;&gt;&quot;2015-02-02T03:39:48.580Z&quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;updatedAt&quot;&lt;/span&gt; : ISODate(&lt;span class=&quot;string&quot;&gt;&quot;2015-02-02T10:29:01.463Z&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;aggregate 操作&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; orders = db.getCollection(&lt;span class=&quot;string&quot;&gt;&#39;order&#39;&lt;/span&gt;).aggregate(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      $match:&amp;#123;oType:&amp;#123;$&lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;:[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;]&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      $project:&amp;#123;amount:&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,createdAt:&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,status:&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,dateAdd8:&amp;#123; $add: [ &lt;span class=&quot;string&quot;&gt;&quot;$createdAt&quot;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;*&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;*&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;*&lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt; ] &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      $group:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        _id:&amp;#123;month:&amp;#123;$month:&lt;span class=&quot;string&quot;&gt;&quot;$dateAdd8&quot;&lt;/span&gt;&amp;#125;,day:&amp;#123;$dayOfMonth:&lt;span class=&quot;string&quot;&gt;&quot;$dateAdd8&quot;&lt;/span&gt;&amp;#125;,year:&amp;#123;$year:&lt;span class=&quot;string&quot;&gt;&quot;$dateAdd8&quot;&lt;/span&gt;&amp;#125;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        totalAmount:&amp;#123;$sum:&lt;span class=&quot;string&quot;&gt;&quot;$amount&quot;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        count:&amp;#123; $sum: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        items:&amp;#123;$push:&amp;#123;amount:&lt;span class=&quot;string&quot;&gt;&quot;$amount&quot;&lt;/span&gt;,status:&lt;span class=&quot;string&quot;&gt;&quot;$status&quot;&lt;/span&gt;&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;).toArray();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样就可以解决ISO日期格式时间比北京时间小8个钟导致按日期分组时出现跨天的问题&lt;/p&gt;
</content>
    
    <summary type="html">
    
      数据库 mongo aggregate
    
    </summary>
    
      <category term="数据库" scheme="http://www.navyxie.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="mongo" scheme="http://www.navyxie.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mongo/"/>
    
    
      <category term="mongo" scheme="http://www.navyxie.com/tags/mongo/"/>
    
      <category term="数据库" scheme="http://www.navyxie.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>收藏</title>
    <link href="http://www.navyxie.com/2016/04/07/collect/"/>
    <id>http://www.navyxie.com/2016/04/07/collect/</id>
    <published>2016-04-06T17:50:29.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/huei90/javascript-sdk-design&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JavaScript SDK 设计指导&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/braziljs/js-the-right-way&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;js-the-right-way&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/revolunet/JSbooks&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JSbooks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/superherojs/superherojs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;superherojs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/84028/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;前端开发者都应知道的 jQuery 小技巧&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/29454/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;常用的 Javascript 设计模式&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/21136/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;10 个 jQuery 图表插件推荐&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/9648/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;理解JavaScript原型&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/56689/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;只有20行Javascript代码！手把手教你写一个页面模板引擎&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/31951/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;编写快速、高效的JavaScript代码&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/54495/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;45个实用的JavaScript技巧、窍门和最佳实践&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/66135/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;为现代JavaScript开发做好准备&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/53199/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;给JavaScript初学者的24条最佳实践&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/8087/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JavaScript的那些书&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/huei90/javascript-sdk-design&quot;&gt;JavaScript SDK 设计指导&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/braziljs/js-the-right-way&quot;&gt;js-the-right-way&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/revolunet/JSbooks&quot;&gt;JSbooks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/superherojs/superherojs&quot;&gt;superherojs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/84028/&quot;&gt;前端开发者都应知道的 jQuery 小技巧&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.jobbole.com/29454/&quot;&gt;常用的 Javascript 设计模式&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="收藏" scheme="http://www.navyxie.com/categories/%E6%94%B6%E8%97%8F/"/>
    
    
      <category term="JavaScript" scheme="http://www.navyxie.com/tags/JavaScript/"/>
    
      <category term="框架" scheme="http://www.navyxie.com/tags/%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>文章</title>
    <link href="http://www.navyxie.com/2016/04/07/post/"/>
    <id>http://www.navyxie.com/2016/04/07/post/</id>
    <published>2016-04-06T17:49:10.000Z</published>
    <updated>2016-07-24T03:27:49.000Z</updated>
    
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/how-to-plugin-development&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;如何进行插件化开发&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/protractor-scenario&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;protractor-scenario(利用protractor进行场景测试)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/karma-unit&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;karma-unit(利用karma进行单元测试)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/html-tpl&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;简单的对象模板&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/webpack&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;webpack构建demo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/npm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;npm包的管理和发布&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/react-demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;react例子&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/vim&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;vim常用命令&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/shell&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;shell常用命令&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/css-layout&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;css-layout布局(rem)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/idcard/blob/master/lib/province_city_area_code.js&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;最新最全行政区域代码&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/react-native-note&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;react-native笔记&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/how-to-plugin-development&quot;&gt;如何进行插件化开发&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/protractor-scenario&quot;&gt;protractor-scenario(利用protractor进行场景测试)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/karma-unit&quot;&gt;karma-unit(利用karma进行单元测试)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/navyxie/html-tpl&quot;&gt;简单的对象模板&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://www.navyxie.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="框架" scheme="http://www.navyxie.com/tags/%E6%A1%86%E6%9E%B6/"/>
    
      <category term="插件化" scheme="http://www.navyxie.com/tags/%E6%8F%92%E4%BB%B6%E5%8C%96/"/>
    
      <category term="npm" scheme="http://www.navyxie.com/tags/npm/"/>
    
      <category term="protractor" scheme="http://www.navyxie.com/tags/protractor/"/>
    
      <category term="测试" scheme="http://www.navyxie.com/tags/%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
</feed>
